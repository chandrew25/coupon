<?php
 require_once IA_ROOT . '/addons/tiger_newhu/inc/sdk/tbk/TopSdk.php'; class Tiger_wxdailiModuleSite extends WeModuleSite { public function __construct() { goto onHT4; KpKkq: $tktzurl = $_W['siteurl']; goto gxoM8; tBCS4: $url = 'http://api1.laohucms.com/sqnew.php?tbuid=' . $tbuid . '&tkurl=' . $tkurl1 . '&tkurl2=' . $tkurl2 . '&tkip=' . $tkip . '&sign=' . md5($tkip . 'tig'); goto BTyIM; SOlvt: if (!($c == 'entry')) { goto kFn3z; } goto s23id; pySL1: $arr = @json_decode($aa, true); goto gAjPZ; Bww7u: $host = $_SERVER['HTTP_HOST']; goto LjDTC; Y_C3R: $tkurl2 = urlencode($_W['setting']['site']['url']); goto ztM3J; mndfN: PTbF9: goto Da8y8; g8GcH: if (!empty($_SESSION['tkuid'])) { goto QVIKn; } goto KpKkq; kB3d4: exit; goto zDZRl; gAjPZ: if (!($arr['error'] == 2)) { goto T60A3; } goto VH3P7; nTgwZ: $c = $_GPC['c']; goto Kxrzy; dt0nw: T60A3: goto Oxj_B; iWUT4: QVIKn: goto mndfN; BTyIM: $aa = $this->curl_request($url); goto pySL1; onHT4: global $_W, $_GPC; goto nTgwZ; zDZRl: CrbMx: goto iWUT4; gU7R3: if (!($do != 'login' and $do != 'bdlogin' and $do != 'tupian')) { goto CrbMx; } goto yZaoF; Oxj_B: if (empty($cfg['tknewurl'])) { goto I_8JV; } goto Ot7RB; LjDTC: $host = strtolower($host); goto eV1_p; gxoM8: $loginurl = $_W['siteroot'] . str_replace('./', 'app/', $this->createMobileurl('login')) . '&m=tiger_newhu' . '&tzurl=' . urlencode($tktzurl); goto gU7R3; Da8y8: kFn3z: goto Fzhgw; wcCQx: I_8JV: goto SOlvt; er12C: $tkurl1 = urlencode($host); goto Y_C3R; Amd3C: $_W['siteroot'] = $cfg['tknewurl']; goto NNe10; Kxrzy: $cfg = $this->module['config']; goto Bww7u; ztM3J: $tkip = $this->get_server_ip(); goto tBCS4; eV1_p: $tbuid = $cfg['tbuid']; goto er12C; yZaoF: header('Location: ' . $loginurl); goto kB3d4; wsdQB: exit; goto dt0nw; Ot7RB: if (!($c == 'entry')) { goto uH5gU; } goto Amd3C; s23id: if (!($cfg['logintype'] == 1)) { goto PTbF9; } goto g8GcH; NNe10: uH5gU: goto wcCQx; VH3P7: echo $arr['msg']; goto wsdQB; Fzhgw: } public function dlzdsh($uid, $share, $guanliopenid = "", $cfg = "") { goto HlCNv; l8vDg: ul8Kx: goto M47gl; ZwGFJ: if (empty($res)) { goto lT7jP; } goto yXP_d; smtfK: xetqI: goto TGsiJ; Van9s: W8iUB: goto u4nIy; qdx0m: if (empty($guanliopenid)) { goto iJcoR; } goto wkMet; NBKoz: $jdpidres = pdo_fetch('select * from ' . tablename('tiger_wxdaili_jdpid') . " where weid='{$_W['uniacid']}' and type=0 order by id desc "); goto ADSK_; ADSK_: if (!empty($jdpidres)) { goto W8iUB; } goto eofMD; ho_3a: if (empty($res)) { goto ul8Kx; } goto u1ITp; M47gl: spSWI: goto Ka3Sc; TGsiJ: $tturl = $cfg['tknewurl'] . str_replace('./', 'app/', $this->createMobileurl('newmember')); goto GM84G; sw2G3: $res = pdo_update('tiger_newhu_share', array("tgwid" => 11111), array("id" => $uid, "weid" => $_W['uniacid'])); goto FSI0u; fQHQL: CtVAB: goto ezcBo; eofMD: if (empty($guanliopenid)) { goto I_LOl; } goto ncu8l; yXP_d: $res = pdo_update('tiger_wxdaili_pddpid', array("type" => 1, "uid" => $share['id'], "nickname" => $share['nickname']), array("id" => $pddpidres['id'])); goto hz6HJ; ezcBo: if (empty($jdpidres['pid'])) { goto spSWI; } goto MB6bM; Ka3Sc: if (empty($pddpidres['pid'])) { goto xetqI; } goto Iq7Fx; u4nIy: $pddpidres = pdo_fetch('select * from ' . tablename('tiger_wxdaili_pddpid') . " where weid='{$_W['uniacid']}' and type=0 order by id desc "); goto j_G5W; FSI0u: Sifsb: goto NBKoz; ywovb: $this->postText($share['from_user'], $dlmsg); goto LsKah; HlCNv: global $_W; goto VY2NC; ncu8l: I_LOl: goto Van9s; j_G5W: if (!empty($pddpidres)) { goto CtVAB; } goto qdx0m; hz6HJ: lT7jP: goto smtfK; wkMet: iJcoR: goto fQHQL; VY2NC: if (!empty($share['tgwid'])) { goto Sifsb; } goto sw2G3; Iq7Fx: $res = pdo_update('tiger_newhu_share', array("pddpid" => $pddpidres['pid'], "dltype" => 1), array("id" => $uid, "weid" => $_W['uniacid'])); goto ZwGFJ; GM84G: $dlmsg = '<a href=\'' . $tturl . '\'>进入合伙人中心</a>
重点：进入合伙人中心，复制口令，打开淘♂寳APP完成渠道授权，未授权不能跟单结算佣金！'; goto ywovb; u1ITp: $res = pdo_update('tiger_wxdaili_jdpid', array("type" => 1, "uid" => $share['id'], "nickname" => $share['nickname']), array("id" => $jdpidres['id'])); goto l8vDg; MB6bM: $res = pdo_update('tiger_newhu_share', array("jdpid" => $jdpidres['pid'], "dltype" => 1), array("id" => $uid, "weid" => $_W['uniacid'])); goto ho_3a; LsKah: } public function get_server_ip() { goto Iysu5; hrYbJ: $server_ip = getenv('SERVER_ADDR'); goto V2tM3; V2tM3: goto B7pTT; goto sf2kk; Iysu5: if (isset($_SERVER)) { goto p2MVi; } goto hrYbJ; zEyaV: goto EKBsX; goto tQpwa; LrvbZ: EKBsX: goto G8j9H; sf2kk: p2MVi: goto L0SrQ; G8j9H: B7pTT: goto JKgiD; yp0WH: $server_ip = $_SERVER['LOCAL_ADDR']; goto zEyaV; L0SrQ: if ($_SERVER['SERVER_ADDR']) { goto wD1Fc; } goto yp0WH; fGARN: $server_ip = $_SERVER['SERVER_ADDR']; goto LrvbZ; tQpwa: wD1Fc: goto fGARN; JKgiD: return $server_ip; goto afivF; afivF: } public function getmember($fans, $wqid, $helpid) { goto hCnpW; AFlSY: qjz0E: goto W7myn; fulx_: if (!empty($fans['openid'])) { goto qjz0E; } goto Oqrbw; mC3cC: qhk52: goto FscLQ; iKWqE: goto NsAWW; goto mUrfO; X_opo: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and from_user='{$fans['openid']}'"); goto eQq_0; FyYGB: I93Je: goto RfHBG; ViBKU: goto I93Je; goto DoRvm; xMp_K: $share['id'] = pdo_insertid(); goto Sr1Yq; vw9Tz: Ji6Nl: goto QlP5w; DoRvm: ihOjS: goto axvqq; Oqrbw: return ''; goto AFlSY; AzAl4: if (!empty($fans['openid'])) { goto f59c4; } goto AdzzA; mUrfO: f59c4: goto kqDg2; fCawQ: goto idqU7; goto PvvBM; e_oPN: I2pXu: goto n7cvU; pVKMH: $share['id'] = pdo_insertid(); goto TU6Jo; oSe0A: pdo_insert('tiger_newhu_share', array("openid" => $wqid, "nickname" => $fans['nickname'], "avatar" => $fans['avatar'], "unionid" => $fans['unionid'], "pid" => "", "updatetime" => time(), "createtime" => time(), "parentid" => 0, "weid" => $_W['uniacid'], "helpid" => $helpid, "score" => "", "cscore" => "", "pscore" => "", "from_user" => $fans['openid'], "follow" => 1)); goto xMp_K; JAuhJ: idqU7: goto FS7i9; jsWAC: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and from_user='{$fans['openid']}'"); goto Tl870; l3m2O: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and unionid='{$fans['unionid']}'"); goto CwNB2; siJjS: CZ6vB: goto FyYGB; W7myn: if (!empty($fans['unionid'])) { goto ihOjS; } goto X_opo; zG2zn: goto Yq2vc; goto vw9Tz; Tl870: if (!empty($share['id'])) { goto Ji6Nl; } goto oSe0A; PTqR0: return $share; goto fCawQ; W9O4N: return $share; goto JAuhJ; ifQib: NsAWW: goto iDuxI; CwNB2: return $share; goto siJjS; JApy8: Yq2vc: goto P61lj; FscLQ: $updata = array("from_user" => $fans['openid'], "openid" => $wqid); goto yRGi9; QlP5w: $updata = array("unionid" => $fans['unionid'], "openid" => $wqid); goto vppq2; vppq2: pdo_update('tiger_newhu_share', $updata, array("from_user" => $fans['openid'], "weid" => $_W['uniacid'])); goto QiEDH; hCnpW: global $_W; goto fulx_; AdzzA: return ''; goto iKWqE; TU6Jo: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and from_user='{$fans['openid']}'"); goto R4C7C; yRGi9: pdo_update('tiger_newhu_share', $updata, array("unionid" => $fans['unionid'], "weid" => $_W['uniacid'])); goto l3m2O; FS7i9: UJrOG: goto ViBKU; R4C7C: return $share; goto ifQib; eQq_0: if (!empty($share['id'])) { goto I2pXu; } goto AzAl4; NK5hH: return $share; goto zG2zn; MZ3VW: $updata = array("unionid" => $fans['unionid'], "openid" => $wqid); goto Po6Iz; sT4kU: return $share; goto JApy8; Po6Iz: pdo_update('tiger_newhu_share', $updata, array("from_user" => $fans['openid'], "weid" => $_W['uniacid'])); goto uJIGS; n7cvU: if (!empty($fans['unionid'])) { goto eADa3; } goto PTqR0; kqDg2: pdo_insert('tiger_newhu_share', array("openid" => $wqid, "nickname" => $fans['nickname'], "avatar" => $fans['avatar'], "unionid" => $fans['unionid'], "pid" => "", "updatetime" => time(), "createtime" => time(), "parentid" => 0, "weid" => $_W['uniacid'], "helpid" => $helpid, "score" => "", "cscore" => "", "pscore" => "", "from_user" => $fans['openid'], "follow" => 1)); goto pVKMH; QiEDH: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and from_user='{$fans['openid']}'"); goto sT4kU; uJIGS: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and from_user='{$fans['openid']}'"); goto W9O4N; E61pr: if (!empty($share['id'])) { goto qhk52; } goto jsWAC; iDuxI: goto UJrOG; goto e_oPN; P61lj: goto CZ6vB; goto mC3cC; axvqq: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and unionid='{$fans['unionid']}'"); goto E61pr; Sr1Yq: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$share['id']}'"); goto NK5hH; PvvBM: eADa3: goto MZ3VW; RfHBG: } public function mc_jl($uid, $type, $typelx, $num, $remark, $orderid) { goto hOTpe; wGNYn: $share = pdo_fetch('SELECT credit1,credit2 FROM ' . tablename('tiger_newhu_share') . " WHERE id='{$uid}' and weid='{$_W['uniacid']}' "); goto o1IzM; uszd0: goto qrth5; goto ugBhn; quddD: return array("error" => 0, "data" => "余额更新失败"); goto qJ0w5; MvwN_: return array("error" => 0, "data" => "积分更新失败"); goto idml6; ot90K: PN2yt: goto bWrL7; T505V: if (!empty($uid)) { goto ojGX7; } goto ZNCJr; W3L2Y: return array("error" => 0, "data" => "余额不足"); goto lLt5E; CWGqK: return array("error" => 0, "data" => "积分更新失败"); goto ta7z0; ZNCJr: return; goto bmXHT; fEnAE: $data = array("uid" => $uid, "weid" => $_W['uniacid'], "type" => $type, "typelx" => $typelx, "num" => $num, "remark" => $remark, "orderid" => $orderid, "createtime" => time()); goto wGNYn; hkLwz: if ($type == 0) { goto PN2yt; } goto QQi56; nLMhX: if (!($credit2 < 0)) { goto iT8uH; } goto W3L2Y; DoWsc: HT0UG: goto YyIkN; wQFxF: xu0xP: goto mSCdE; ugBhn: fjWds: goto CWGqK; bmXHT: ojGX7: goto fEnAE; lLt5E: iT8uH: goto Mf3Ln; w6YKw: if (!($credit1 < 0)) { goto HT0UG; } goto kZr9f; QQi56: goto s1qFz; goto e0f8T; hOTpe: global $_W; goto T505V; qJ0w5: atWu4: goto KR_qN; CUNwk: if ($inst === false) { goto xu0xP; } goto VxywE; cunhB: if ($res === false) { goto JloF4; } goto FaVEq; idml6: Ew1vM: goto ZT2zy; o1IzM: if ($type == 1) { goto sp0Xd; } goto hkLwz; Mf3Ln: $res = pdo_update('tiger_newhu_share', array("credit2" => $credit2), array("id" => $uid)); goto cunhB; G_ogp: pwy3I: goto NTeLi; e0f8T: sp0Xd: goto ezdo9; mSCdE: return array("error" => 0, "data" => "余额更新失败"); goto G_ogp; h_YTY: JloF4: goto quddD; YyIkN: $res = pdo_update('tiger_newhu_share', array("credit1" => $credit1), array("id" => $uid)); goto iBjYd; mICXO: goto Ew1vM; goto eRQaf; kZr9f: return array("error" => 0, "data" => "积分不足"); goto DoWsc; eRQaf: feTJO: goto MvwN_; ZT2zy: s1qFz: goto lzn_I; rcY1h: if ($inst === false) { goto fjWds; } goto pdLpw; VxywE: return array("error" => 1, "data" => "余额更新成功"); goto qxePt; NTeLi: goto atWu4; goto h_YTY; FaVEq: $inst = pdo_insert('tiger_newhu_jl', $data); goto CUNwk; qxePt: goto pwy3I; goto wQFxF; iBjYd: if ($res === false) { goto feTJO; } goto lvhyu; ezdo9: $credit2 = $share['credit2'] + $num; goto nLMhX; lvhyu: $inst = pdo_insert('tiger_newhu_jl', $data); goto rcY1h; pdLpw: return array("error" => 1, "data" => "积分更新成功"); goto uszd0; KR_qN: goto s1qFz; goto ot90K; bWrL7: $credit1 = $share['credit1'] + $num; goto w6YKw; ta7z0: qrth5: goto mICXO; lzn_I: } public function islogin() { goto Ee2Dw; y7gWv: if (empty($_SESSION['openid'])) { goto sm8nd; } goto e0HxF; tBhI9: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$_SESSION['tkuid']}'"); goto R43Ah; e0HxF: $fans['openid'] = $_SESSION['openid']; goto tBhI9; R43Ah: sm8nd: goto SYvcC; SYvcC: $mc = mc_fetch($fans['openid']); goto Mihcn; Ee2Dw: global $_W; goto y7gWv; k573w: return $fans; goto BTpp0; Mihcn: $fans = array("id" => $_SESSION['tkuid'], "tkuid" => $_SESSION['tkuid'], "wquid" => $mc['uid'], "credit1" => $share['credit1'], "credit2" => $share['credit2'], "nickname" => $share['nickname'], "avatar" => $share['avatar'], "helpid" => $share['helpid'], "dlptpid" => $share['dlptpid'], "unionid" => $share['unionid'], "from_user" => $share['from_user'], "openid" => $share['from_user'], "createtime" => $share['createtime'], "tgwid" => $share['tgwid'], "cqtype" => $share['cqtype'], "dltype" => $share['dltype'], "status" => $share['status']); goto k573w; BTpp0: } public function getfc($string, $len = 2) { goto kzxtX; MRyko: goto prGMj; goto z8g4u; vVM3d: $strlen = mb_strlen($string); goto MRyko; Ei1ZS: $string = mb_substr($string, $len, $strlen, 'utf8'); goto vVM3d; cYGW9: prGMj: goto db1aS; kzxtX: $string = str_replace(' ', '', $string); goto gFYF3; FfkVA: $array[] = mb_substr($string, $start, $len, 'utf8'); goto Ei1ZS; gFYF3: $start = 0; goto Urzf0; Urzf0: $strlen = mb_strlen($string); goto cYGW9; z8g4u: CkVk6: goto Rxget; Rxget: return $array; goto qNZb_; db1aS: if (!$strlen) { goto CkVk6; } goto FfkVA; qNZb_: } public function tjsum($id, $weid) { goto PO8bF; d4IPN: WEDrc: goto HU5Bu; CiBjB: N0ePw: goto ncU8Q; LHV0C: return $total; goto vX8dt; ncU8Q: return 0; goto d4IPN; gfmh2: if (empty($total)) { goto N0ePw; } goto LHV0C; vX8dt: goto WEDrc; goto CiBjB; PO8bF: $total = pdo_fetchcolumn('SELECT COUNT(*) FROM ' . tablename($this->modulename . '_qunmember') . " where weid='{$weid}' and qunid='{$id}'"); goto gfmh2; HU5Bu: } public function gettaopic($numid) { goto lMEGY; m0yAb: settype($pic, 'string'); goto SZKXR; b11AW: $req->setFields('pict_url'); goto I3_g3; S0TwU: $resp = $c->execute($req); goto kiSf4; I3_g3: $req->setPlatform('1'); goto zYLr_; oY2ge: $c = new TopClient(); goto Mz439; zYLr_: $req->setNumIids($numid); goto S0TwU; Mz439: $c->appkey = $cfg['tkAppKey']; goto NVa8C; SZKXR: return $pic; goto ZtFO5; NVa8C: $c->secretKey = $cfg['tksecretKey']; goto kK8AD; lMEGY: $cfg = $this->module['config']; goto oY2ge; kK8AD: $req = new TbkItemInfoGetRequest(); goto b11AW; kiSf4: $pic = $resp->results->n_tbk_item->pict_url; goto m0yAb; ZtFO5: } public function jyze($share, $begin_time, $end_time, $type, $bl) { goto M6rWX; uXqoR: $where = "and addtime>{$begin_time}"; goto resFg; dOQrR: uKCoP: goto Dyf_a; KYv0g: V1ESd: goto DGcj4; X2wq3: if (empty($begin_time)) { goto uKCoP; } goto BtuP8; cFRKr: $jy = pdo_fetchcolumn('SELECT sum(fkprice) FROM ' . tablename('tiger_newhu_tkorder') . " where weid='{$_W['uniacid']}' and (tgwid={$share['tgwid']} || relation_id='{$share['qdid']}'} and orderzt<>'订单失效' {$where}"); goto cZOpP; BtuP8: $where = "and addtime>{$begin_time} and addtime<{$end_time}"; goto dOQrR; KzAof: YV2_k: goto RRr0Z; ygjxF: $jy = pdo_fetchcolumn('SELECT sum(fkprice) FROM ' . tablename('tiger_newhu_tkorder') . " where weid='{$_W['uniacid']}' and tgwid={$share['tgwid']} and orderzt<>'订单失效' {$where}"); goto KYv0g; RRr0Z: if (empty($begin_time)) { goto hcFy0; } goto uXqoR; ItTgp: if (!($type == 1)) { goto nRKs4; } goto VWmph; DGcj4: nRKs4: goto gznOQ; gznOQ: return $jy; goto l4nkc; gPdJv: ek5IY: goto ygjxF; yq9Zt: if (empty($end_time)) { goto YV2_k; } goto X2wq3; resFg: hcFy0: goto wtTEH; Dyf_a: goto nES0i; goto KzAof; cZOpP: goto V1ESd; goto gPdJv; VWmph: if (empty($share['qdid'])) { goto ek5IY; } goto cFRKr; wtTEH: nES0i: goto ItTgp; M6rWX: global $_W; goto yq9Zt; l4nkc: } public function tqbl($share, $bl, $cfg) { goto B5Scg; w8Xqn: SU5d4: goto KYk6r; PBvgK: adbTX: goto NDWIL; NKZSk: $cj = $fs['cj']; goto eQHaN; wOp_P: Rqxkf: goto sB9qy; xv7Qs: $syzyj = '0.00'; goto TiRV6; ZBvsE: if (!empty($zjrzyj)) { goto OS877; } goto HDg1I; kN7Z1: goto Fw126; goto IeTgr; s7uDx: if (!empty($zrsjyj)) { goto Kh0at; } goto x2zK_; MFcgZ: XteC7: goto HUcVm; vzPAR: $bbegin_time = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto DdwYT; gyp2a: $fs = $this->jcbl($share, $bl); goto NKZSk; gR1yP: $wsysjyj = '0.00'; goto Lx0cR; aScrJ: $rjyj = '0.00'; goto A8cGZ; K4Kj3: n48CZ: goto cLtGg; wbVvl: $brzyj = '0.00'; goto P3wIB; h86QC: $zrzyj = $zrygsum + $zrrjyj + $zrsjyj; goto PBvgK; JlGTb: $syrsjyj = $this->bydlyj($share, $sbegin_time, $send_time, 1, $bl, $cfg, 1); goto o284O; jNr_8: XoF_C: goto s7uDx; LQVO2: Fw126: goto x2bHo; lGmTR: lHAvX: goto SgGXk; Daag6: $wsyygsum = number_format($wsyygsum, 2, '.', ''); goto dwm33; JPIVB: $byygsum = $this->bryj($share, $bbegin_time, $bend_time, 1, $bl, $cfg, 1); goto CS4y9; n2lmA: $where = " and  (tgwid='{$share['tgwid']}' || relation_id='{$share['qdid']}') "; goto eXEC_; TiRV6: C5_Pn: goto BgJh1; G5vbe: if (!empty($syrjyj)) { goto UySWU; } goto oLpkm; lJMqN: goto Dvs7d; goto bBQuu; FC0mQ: $sbegin_time = strtotime(date('Y-m-d', mktime(0, 0, 0, date('m') - 1, 1, date('Y')))); goto jW6aV; NDWIL: if (!empty($zrzyj)) { goto enqhh; } goto HioVM; YgGoO: $syygsum = $this->bryj($share, $sbegin_time, $send_time, 1, $bl, $cfg, 1); goto xWuzh; KYk6r: $wsyrjyj = number_format($wsyrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2); goto W7K8t; xXNZa: if (!empty($jrzyj)) { goto l39kx; } goto XFOnB; IueWI: $zrrjyj = number_format($zrrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto Spkhg; Xv97U: goto n48CZ; goto p_2DF; fGBie: $where = ''; goto ufqLp; Lx0cR: Px1wQ: goto hldB2; MvczC: if (!empty($syygsum)) { goto oYpaF; } goto HCACv; ZyjdF: $rsjyj = $this->bydlyj($share, $bbegin_time, $bend_time, 1, $bl, $cfg, 1); goto DGfKX; toVFF: goto a6iRE; goto Y7VpI; Y7VpI: kZLwG: goto IueWI; tVjc4: $zrrsjyj = $this->bydlyj($share, $zttime, $daytime, 3, $bl, $cfg); goto a_KZ8; cBtby: $wsyygsum = '0.00'; goto IvWKG; CGZvJ: if ($bl['dltype'] == 2) { goto kZLwG; } goto k1XMG; uHiE5: $jrygsum = number_format($jrygsum, 2, '.', ''); goto OEbUs; Hq4Ij: $zrzyj = $zrygsum + $zrrjyj + $zrsjyj; goto X3LLz; SYaFE: if (!empty($rjyj)) { goto JLpTN; } goto aScrJ; GrlaO: if (!empty($wsysjyj)) { goto Px1wQ; } goto gR1yP; NWLAl: $jrsjyj = number_format($jrjyj['yj3'], 2, '.', ''); goto qgUg_; om2Yo: $byfksum = $this->bryj($share, $bbegin_time, $bend_time, 2, $bl, $cfg); goto xvceU; HDg1I: $zjrzyj = '0.00'; goto NCodY; A8cGZ: JLpTN: goto Khfz_; aVh64: goto n48CZ; goto tYQdP; qVNUY: fdRuo: goto l0rc2; ad2hG: $sjyj = '0.00'; goto p7DX8; CS4y9: $byygsum = number_format($byygsum, 2, '.', ''); goto ZyjdF; GzuDa: $jryj = number_format($jrjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto YKty8; uqq5j: $zrrjyj = number_format($zrrsjyj['yj2'], 2, '.', ''); goto pMZYT; nNw7t: $sjyj = number_format($rsjyj['yj3'], 2, '.', ''); goto NcSv2; IvWKG: WLqdN: goto j1n7l; YSbhP: a6iRE: goto Hq4Ij; LIWup: UdOV8: goto uqq5j; CJ95J: if (!empty($zrrjyj)) { goto XoF_C; } goto JVYgA; Spkhg: $zrsjyj = '0.00'; goto jpUZ5; VkJpv: KaJkz: goto VUebh; HioVM: $zrzyj = '0.00'; goto ieMKA; fEGCD: if (!empty($sysjyj)) { goto UPfZC; } goto xbEhK; W3BeR: goto CMHnL; goto GNZK0; h2Txf: $rjfkyj = number_format($rsjfkyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto SVLaf; lbHu4: $rsjfkyj = $this->bydlyj($share, $bbegin_time, $bend_time, 2, $bl, $cfg); goto KnEpw; L_XE1: Egj07: goto OdwJa; xUfhO: tVGWQ: goto F77J9; jnci0: $wsysjyj = number_format($wsyrsjyj['yj3'], 2, '.', ''); goto fKtFE; eXEC_: goto SZ1z3; goto VkJpv; OFYCO: $rjfkyj = number_format($rsjfkyj['yj2'], 2, '.', ''); goto aPZot; pMZYT: $zrsjyj = number_format($zrrsjyj['yj3'], 2, '.', ''); goto h86QC; u0dI2: nwwJw: goto Oxl2H; XyphC: $brzfkyj = $byfksum + $rjfkyj + $sjfkyj; goto GkMqo; oYVX0: if (!empty($brzyj)) { goto P1epe; } goto wbVvl; XO0EO: if ($bl['dltype'] == 2) { goto ktYZy; } goto VBz5D; VUebh: $where = " and tgwid='{$share['tgwid']}'"; goto o_AkQ; JVYgA: $zrrjyj = '0.00'; goto jNr_8; Ug6Ch: oYpaF: goto G5vbe; xbEhK: $sysjyj = '0.00'; goto BwYDe; Xw6c8: $byygsum = '0.00'; goto nvVzJ; z3gXk: nAsw8: goto MBkxY; SVLaf: $sjfkyj = '0.00'; goto lJMqN; eQHaN: $jrygsum = $this->bryj($share, $daytime, '', 3, $bl, $cfg); goto uHiE5; BwYDe: UPfZC: goto awsTa; bBQuu: kJr3I: goto Vlr5o; n2Upc: UySWU: goto fEGCD; W37Dg: MPPrJ: goto SwnLV; mIPai: if ($bl['dltype'] == 3) { goto mcmPX; } goto aVh64; SwnLV: if (!empty($wsyygsum)) { goto WLqdN; } goto cBtby; rDnYH: jrwVp: goto MvczC; HCACv: $syygsum = '0.00'; goto Ug6Ch; k1XMG: if ($bl['dltype'] == 3) { goto XteC7; } goto toVFF; aPZot: $sjfkyj = number_format($rsjfkyj['yj3'], 2, '.', ''); goto Ln7Eb; X_Ce6: rea1I: goto IqCNF; LbUuG: jW0hQ: goto YgGoO; vXaap: $rjyj = number_format($rsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto PNHJi; Khfz_: if (!empty($sjyj)) { goto VC8t2; } goto ad2hG; JBWTI: $sysjyj = number_format($syrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto wOp_P; zaofQ: $syzyj = '0.00'; goto rDnYH; jW6aV: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto fGBie; ufqLp: if (empty($share['qdid'])) { goto KaJkz; } goto n2lmA; OmEbg: xmA1Z: goto zZDq_; F77J9: if (!empty($syzyj)) { goto C5_Pn; } goto xv7Qs; qTDcA: $jryj = '0.00'; goto JOvo4; x2zK_: $zrsjyj = '0.00'; goto LV_2s; fKtFE: $wsyzyj = $wsyygsum + $wsyrjyj + $wsysjyj; goto xYY_k; n00If: goto aqu1c; goto lGmTR; cE9xl: if ($bl['dltype'] == 2) { goto PJRTC; } goto mIPai; hldB2: if (!empty($brzyj)) { goto RreUQ; } goto EHFmg; l0rc2: $jryj = number_format($jrjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto kN7Z1; qx8Jf: if ($bl['dltype'] == 2) { goto SU5d4; } goto wamX8; YKty8: $jrsjyj = number_format($jrjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto LQVO2; OdwJa: $wsyrjyj = number_format($wsyrsjyj['yj2'], 2, '.', ''); goto jnci0; gq0Gp: $jryj = number_format($jrjyj['yj2'], 2, '.', ''); goto NWLAl; GkMqo: goto uorkl; goto kxxRB; B5Scg: global $_W; goto COr_K; GHyHq: $zttime = strtotime(date('Y-m-d 00:00:00', strtotime('-1 day'))); goto vzPAR; COr_K: $daytime = strtotime(date('Y-m-d 00:00:00')); goto GHyHq; jpUZ5: goto a6iRE; goto MFcgZ; Ca7Vt: voQLM: goto n51uI; jId5_: CMHnL: goto liaNC; lfrSY: ktYZy: goto QWcyJ; a_KZ8: if ($bl['fxtype'] == 1) { goto UdOV8; } goto CGZvJ; XKJxk: goto Rqxkf; goto lfrSY; P3wIB: P1epe: goto om2Yo; W7K8t: goto nwwJw; goto X_Ce6; Ljgx0: $zrsjyj = number_format($zrrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto YSbhP; YbWFm: hthkJ: goto CJ95J; liaNC: if (!empty($jrzyj)) { goto xmA1Z; } goto Z0pFs; cA4oP: uorkl: goto QLeK3; q1WTC: $wsyrjyj = '0.00'; goto eoB69; ASAVj: if ($bl['dltype'] == 3) { goto ZXlXI; } goto q1OD2; Na3UR: if ($bl['fxtype'] == 1) { goto gnQp5; } goto BhEzD; f9FcY: $jrygsum = '0.00'; goto Ca7Vt; QWcyJ: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto g7LXk; JJhZx: $brzfkyj = '0.00'; goto LbUuG; SgGXk: $rjyj = number_format($rsjyj['yj2'], 2, '.', ''); goto nNw7t; IqCNF: $wsyrjyj = number_format($wsyrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2); goto Wzxfv; Z0pFs: $jrzyj = '0.00'; goto OmEbg; bNqgH: if (!empty($jrygsum)) { goto voQLM; } goto f9FcY; cLtGg: $brzyj = $byygsum + $rjyj + $sjyj; goto n00If; xWuzh: $syygsum = number_format($syygsum, 2, '.', ''); goto JlGTb; X3LLz: goto adbTX; goto LIWup; ieMKA: enqhh: goto JPIVB; c53qd: q9me0: goto h2Txf; xBmYu: $wsyzyj = '0.00'; goto W37Dg; Vlr5o: $rjfkyj = number_format($rsjfkyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto uF013; zZDq_: $zrygsum = $this->bryj($share, $zttime, $daytime, 3, $bl, $cfg); goto VvI3e; VBz5D: if ($bl['dltype'] == 3) { goto nAsw8; } goto XKJxk; Wzxfv: $wsysjyj = number_format($wsyrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2); goto u0dI2; RLy7k: $jrsjyj = '0.00'; goto YbWFm; qgUg_: $jrzyj = $jrygsum + $jryj + $jrsjyj; goto jId5_; nDxl2: if (!empty($byygsum)) { goto VSvEU; } goto Xw6c8; DGfKX: if ($bl['fxtype'] == 1) { goto lHAvX; } goto cE9xl; iT8bw: $rjyj = number_format($rsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto xqi2P; QLeK3: if (!empty($brzfkyj)) { goto jW0hQ; } goto JJhZx; eQMDk: x8UZE: goto eq5Gk; tYQdP: PJRTC: goto vXaap; oLpkm: $syrjyj = '0.00'; goto n2Upc; sB9qy: $syzyj = $syygsum + $syrjyj + $sysjyj; goto CRjfX; DdwYT: $bend_time = strtotime(date('Y-m-d H:i:s', mktime(23, 59, 59, date('m'), date('t'), date('Y')))); goto FC0mQ; PNHJi: $sjyj = '0.00'; goto Xv97U; RtMus: Dvs7d: goto XyphC; KnEpw: if ($bl['fxtype'] == 1) { goto xR9Ip; } goto G3iFi; wamX8: if ($bl['dltype'] == 3) { goto rea1I; } goto Q2GAb; BgJh1: $wsyygsum = $this->bryj($share, $sbegin_time, $send_time, 2, $bl, $cfg); goto Daag6; kxxRB: xR9Ip: goto OFYCO; q1OD2: goto Fw126; goto qVNUY; j1n7l: if (!empty($wsyrjyj)) { goto Ar085; } goto q1WTC; MBkxY: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto JBWTI; dwm33: $wsyrsjyj = $this->bydlyj($share, $sbegin_time, $send_time, 2, $bl, $cfg); goto HmAt4; Ln7Eb: $brzfkyj = $byfksum + $rjfkyj + $sjfkyj; goto cA4oP; x2bHo: $jrzyj = $jrygsum + $jryj + $jrsjyj; goto W3BeR; BhEzD: if ($bl['dltype'] == 2) { goto fdRuo; } goto ASAVj; Oxl2H: $wsyzyj = $wsyygsum + $wsyrjyj + $wsysjyj; goto kFfhI; uF013: $sjfkyj = number_format($rsjfkyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto RtMus; n51uI: if (!empty($jryj)) { goto qGhJD; } goto qTDcA; CRjfX: goto tVGWQ; goto eQMDk; LV_2s: Kh0at: goto D_Wz3; eq5Gk: $syrjyj = number_format($syrsjyj['yj2'], 2, '.', ''); goto iTDA7; D_Wz3: $array = array("zong" => $zjrzyj, "s1" => $syzyj, "s2" => $syygsum, "s3" => $syrjyj, "s4" => $sysjyj, "s5" => $wsyzyj, "s6" => $wsyygsum, "s7" => $wsyrjyj, "s8" => $wsysjyj, "b1" => $brzyj, "b2" => $byygsum, "b3" => $rjyj, "b4" => $sjyj, "d1" => $brzfkyj, "d2" => $byfksum, "d3" => $rjfkyj, "d4" => $sjfkyj, "z1" => $zrzyj, "z2" => $zrygsum, "z3" => $zrrjyj, "z4" => $zrsjyj, "j1" => $jrzyj, "j2" => $jrygsum, "j3" => $jryj, "j4" => $jrsjyj); goto wTm3g; wTm3g: return $array; goto BcpTd; ZIlBs: goto Dvs7d; goto c53qd; VvI3e: $zrygsum = number_format($zrygsum, 2, '.', ''); goto tVjc4; JOvo4: qGhJD: goto VBrTC; GNZK0: gnQp5: goto gq0Gp; eoB69: Ar085: goto GrlaO; nvVzJ: VSvEU: goto SYaFE; o284O: if ($bl['fxtype'] == 1) { goto x8UZE; } goto XO0EO; NCodY: OS877: goto zfso6; VBrTC: if (!empty($jrsjyj)) { goto hthkJ; } goto RLy7k; zfso6: if (!empty($syzyj)) { goto jrwVp; } goto zaofQ; bYSQe: $syzyj = $syygsum + $syrjyj + $sysjyj; goto xUfhO; OEbUs: $jrjyj = $this->bydlyj($share, $daytime, '', 3, $bl, $cfg); goto Na3UR; xvceU: $byfksum = number_format($byfksum, 2, '.', ''); goto lbHu4; NsrzU: if ($bl['dltype'] == 3) { goto kJr3I; } goto ZIlBs; IeTgr: ZXlXI: goto GzuDa; xqi2P: $sjyj = number_format($rsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto K4Kj3; o_AkQ: SZ1z3: goto gyp2a; EHFmg: $brzyj = '0.00'; goto tQRtG; p_2DF: mcmPX: goto iT8bw; kFfhI: goto sNKQx; goto L_XE1; sFIyX: l39kx: goto bNqgH; awsTa: if (!empty($wsyzyj)) { goto MPPrJ; } goto xBmYu; NcSv2: $brzyj = $byygsum + $rjyj + $sjyj; goto uq709; G3iFi: if ($bl['dltype'] == 2) { goto q9me0; } goto NsrzU; tQRtG: RreUQ: goto nDxl2; Q2GAb: goto nwwJw; goto w8Xqn; xYY_k: sNKQx: goto ZBvsE; uq709: aqu1c: goto oYVX0; HmAt4: if ($bl['fxtype'] == 1) { goto Egj07; } goto qx8Jf; HUcVm: $zrrjyj = number_format($zrrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto Ljgx0; iTDA7: $sysjyj = number_format($syrsjyj['yj3'], 2, '.', ''); goto bYSQe; p7DX8: VC8t2: goto xXNZa; XFOnB: $jrzyj = '0.00'; goto sFIyX; g7LXk: goto Rqxkf; goto z3gXk; BcpTd: } public function pddtqbl($share, $bl, $cfg) { goto k0qSO; HhLnz: jVaLR: goto fnt7b; QWnMm: if (!empty($brzyj)) { goto N81eW; } goto KNuBS; YvIVN: goto SafDm; goto OrzGn; AVleg: Hsaez: goto CsFRI; OZcSt: if (!empty($zrsjyj)) { goto Hsaez; } goto YJ0kH; POPi7: $jryj = number_format($jrjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto CzIKs; R2pIc: $zrsjyj = '0.00'; goto nCnFf; MePQW: $brzyj = '0.00'; goto krJcU; fnt7b: $zrzyj = $zrygsum + $zrrjyj + $zrsjyj; goto IAYbe; xIZzC: $cj = $fs['cj']; goto ZHprs; LJbwv: $zrsjyj = number_format($zrrsjyj['yj3'], 2, '.', ''); goto V2PSg; fEEHs: ICYIl: goto zbLmF; Smnhg: $jrzyj = '0.00'; goto u1Qwm; eXb_k: $wsyygsum = number_format($wsyygsum, 2, '.', ''); goto JU5aN; cusFq: if (!empty($rjyj)) { goto Mf8n2; } goto EUKrE; XELcQ: $wsyygsum = '0.00'; goto Oy87C; r7B8Y: if (!empty($jryj)) { goto cQKnW; } goto n5Xi4; U1Mtx: iFo0V: goto coQVj; n5Xi4: $jryj = '0.00'; goto FXe1o; JQ7Dn: $zrrjyj = '0.00'; goto RrFLK; tY7cR: $rjyj = number_format($rsjyj['yj2'], 2, '.', ''); goto CJRgb; ak2KK: $sysjyj = number_format($syrsjyj['yj3'], 2, '.', ''); goto ETROq; IpYXA: if (!empty($jrsjyj)) { goto OPPnt; } goto FjbUu; L5eUP: $jrygsum = number_format($jrygsum, 2, '.', ''); goto MBYAY; Z8nxH: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto TCj0D; XhC6m: $zrrjyj = number_format($zrrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto R2pIc; mBnbX: if (!empty($wsysjyj)) { goto tRk7F; } goto XEhl3; t53NI: if (!empty($wsyrjyj)) { goto msaBz; } goto P0dRV; r3t1y: MkmBQ: goto tY7cR; ihqXz: goto WJ139; goto WEXvK; d2jAj: if (!empty($sjyj)) { goto itjsJ; } goto LZysM; BLd8x: A8gbN: goto sPi7v; IAYbe: goto lp1Vg; goto xnZHQ; ZHprs: $jrygsum = $this->pddbryj($share, $daytime, '', 1, $bl, $cfg); goto L5eUP; wVnGm: $sysjyj = number_format($syrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto lbhvH; zidum: if ($bl['fxtype'] == 1) { goto MkmBQ; } goto Y2Vd5; krJcU: uo0OC: goto QygWh; CzIKs: goto WJ139; goto UrrdQ; iwTbv: $syrjyj = '0.00'; goto SeyOA; JUO9l: $rsjyj = $this->pddbydlyj($share, $bbegin_time, $bend_time, 2, $bl, $cfg); goto zidum; orEVE: $rjfkyj = number_format($rsjfkyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto EJ0T6; Y2Vd5: if ($bl['dltype'] == 2) { goto nrMgx; } goto dqXed; EfGB2: goto WQpOj; goto BLd8x; KSwSC: if (!empty($jrzyj)) { goto iFo0V; } goto uCbFq; TUGGr: $sjyj = '0.00'; goto DhBO7; ooSXR: v0bH5: goto g4p_4; iAwnq: $sjyj = number_format($rsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto QCkvB; J1eiQ: O01El: goto Ywelf; eEmea: $jrygsum = '0.00'; goto jYOz9; lbhvH: WQpOj: goto V7bck; OCYWC: if ($bl['dltype'] == 3) { goto EDCIk; } goto c8VXM; zbLmF: $syygsum = $this->pddbryj($share, $sbegin_time, $send_time, 2, $bl, $cfg, 1); goto GOW2Q; osiR9: $zrrjyj = number_format($zrrsjyj['yj2'], 2, '.', ''); goto LJbwv; MYvBC: if (!empty($zrzyj)) { goto Ux1_4; } goto T1Q4M; ETROq: $syzyj = $syygsum + $syrjyj + $sysjyj; goto B2YNK; cq4VG: $brzyj = $byygsum + $rjyj + $sjyj; goto PCHI_; FCc8C: Lsl2W: goto ko0wS; LKFv4: if (!empty($zrrjyj)) { goto lb_um; } goto JQ7Dn; BAuVg: if ($bl['dltype'] == 2) { goto moTc3; } goto l3gvz; V7bck: $syzyj = $syygsum + $syrjyj + $sysjyj; goto cThEk; RrFLK: lb_um: goto OZcSt; x2W6G: if ($bl['dltype'] == 3) { goto H3loS; } goto ihqXz; FhbB1: $wsyzyj = '0.00'; goto cEwuk; P0dRV: $wsyrjyj = '0.00'; goto WOZd5; kUm0d: if ($bl['fxtype'] == 1) { goto FVIZW; } goto zEyjV; CJRgb: $sjyj = number_format($rsjyj['yj3'], 2, '.', ''); goto cq4VG; elzuY: $sjfkyj = number_format($rsjfkyj['yj3'], 2, '.', ''); goto c0Tdt; wNnEw: ZqA1i: goto IqwDt; FaSAn: WJ139: goto MFU3R; LZysM: $sjyj = '0.00'; goto ga6po; Zi1bk: if (!empty($wsyzyj)) { goto F4od6; } goto FhbB1; vsM9v: if ($bl['dltype'] == 3) { goto v0bH5; } goto dCsLY; u1Qwm: Xdyq0: goto w4CbM; ZbZF5: tRk7F: goto QWnMm; wx6lp: $rsjfkyj = $this->pddbydlyj($share, $bbegin_time, $bend_time, 1, $bl, $cfg); goto akxBJ; QygWh: $byfksum = $this->pddbryj($share, $bbegin_time, $bend_time, 1, $bl, $cfg); goto NaoHo; vbmZV: if (!empty($byygsum)) { goto IfYYF; } goto sLLsz; TybH0: kM0O3: goto fL3RK; sZOpS: goto apCYY; goto xKO9g; NaoHo: $byfksum = number_format($byfksum, 2, '.', ''); goto wx6lp; Mupfb: $jrsjyj = number_format($jrjyj['yj3'], 2, '.', ''); goto kMw5t; aBY5E: $wsyzyj = $wsyygsum + $wsyrjyj + $wsysjyj; goto eFFCm; c7Q85: goto jkY4c; goto J1eiQ; uU_JN: $bend_time = strtotime(date('Y-m-d H:i:s', mktime(23, 59, 59, date('m'), date('t'), date('Y')))); goto cfBQI; cfBQI: $sbegin_time = strtotime(date('Y-m-d', mktime(0, 0, 0, date('m') - 1, 1, date('Y')))); goto Z8nxH; JRBNK: $syrsjyj = $this->pddbydlyj($share, $sbegin_time, $send_time, 2, $bl, $cfg, 1); goto AGsfD; A1H_c: $zrygsum = number_format($zrygsum, 2, '.', ''); goto R2_Pm; B2YNK: Fobrd: goto H8uYT; Rac7h: Mf8n2: goto d2jAj; qeOvd: $jrsjyj = number_format($jrjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto FaSAn; CntTZ: $wsyrjyj = number_format($wsyrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2); goto jtIlU; H8uYT: if (!empty($syzyj)) { goto y1t4O; } goto l0lJL; DhBO7: goto SafDm; goto X30ly; zbmVy: EDCIk: goto orEVE; c8VXM: goto W4sWW; goto qG0qS; MFU3R: $jrzyj = $jrygsum + $jryj + $jrsjyj; goto c7Q85; gOMT4: y1t4O: goto UhSI9; x4Djj: $rjfkyj = number_format($rsjfkyj['yj2'], 2, '.', ''); goto elzuY; jtIlU: goto apCYY; goto CE8Ga; PS5h4: $brzfkyj = '0.00'; goto fEEHs; Ix5xy: $brzyj = $byygsum + $rjyj + $sjyj; goto uvJ4B; dFA8V: $syrjyj = number_format($syrsjyj['yj2'], 2, '.', ''); goto ak2KK; KNuBS: $brzyj = '0.00'; goto g1ht6; PCHI_: Vxcub: goto hIloT; cEwuk: F4od6: goto uqTAY; u2NE8: $zjrzyj = '0.00'; goto haC4m; k0qSO: global $_W; goto jNA39; zWXXY: lp1Vg: goto MYvBC; eFFCm: goto oDdVS; goto RGu4V; IfEJ7: $wsysjyj = number_format($wsyrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2); goto infnO; JtcAS: return $array; goto TyaUL; wRVCp: $byygsum = $this->pddbryj($share, $bbegin_time, $bend_time, 2, $bl, $cfg); goto zl9tM; GOW2Q: $syygsum = number_format($syygsum, 2, '.', ''); goto JRBNK; EUKrE: $rjyj = '0.00'; goto Rac7h; zl9tM: $byygsum = number_format($byygsum, 2, '.', ''); goto JUO9l; JU5aN: $wsyrsjyj = $this->pddbydlyj($share, $sbegin_time, $send_time, 1, $bl, $cfg); goto kUm0d; RGu4V: FVIZW: goto yn32Y; QTqgt: $sjfkyj = '0.00'; goto yEAPm; FjbUu: $jrsjyj = '0.00'; goto X8z0y; I3Bn8: goto WQpOj; goto ohYQN; dCsLY: goto jVaLR; goto hSNTY; cThEk: goto Fobrd; goto aEGsh; YX674: $zttime = strtotime(date('Y-m-d 00:00:00', strtotime('-1 day'))); goto BRgmm; eNgXr: if (!empty($sysjyj)) { goto vAbXn; } goto rUZG2; jYOz9: k1cvq: goto r7B8Y; EF1UC: W4sWW: goto X8WAD; X8z0y: OPPnt: goto LKFv4; EJ0T6: $sjfkyj = number_format($rsjfkyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto EF1UC; uqTAY: if (!empty($wsyygsum)) { goto OCIU8; } goto XELcQ; hIloT: if (!empty($brzyj)) { goto uo0OC; } goto MePQW; jNA39: $daytime = strtotime(date('Y-m-d 00:00:00')); goto YX674; X8WAD: $brzfkyj = $byfksum + $rjfkyj + $sjfkyj; goto WS193; l3gvz: if ($bl['dltype'] == 3) { goto A8gbN; } goto I3Bn8; hI1yc: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto EfGB2; YJ0kH: $zrsjyj = '0.00'; goto AVleg; yn32Y: $wsyrjyj = number_format($wsyrsjyj['yj2'], 2, '.', ''); goto sqL7Q; w4CbM: $zrygsum = $this->pddbryj($share, $zttime, $daytime, 1, $bl, $cfg); goto A1H_c; haC4m: i7XFJ: goto Xpul7; O6UTO: jkY4c: goto WntfQ; kMw5t: $jrzyj = $jrygsum + $jryj + $jrsjyj; goto O6UTO; FeZEM: if ($bl['dltype'] == 3) { goto TdNPL; } goto sZOpS; AGsfD: if ($bl['fxtype'] == 1) { goto weoYe; } goto BAuVg; xKO9g: TWUMt: goto CntTZ; g1ht6: N81eW: goto vbmZV; g4p_4: $zrrjyj = number_format($zrrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto BzJLB; P_v7Q: $syygsum = '0.00'; goto wNnEw; BzJLB: $zrsjyj = number_format($zrrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto HhLnz; o7Dk5: if ($bl['dltype'] == 2) { goto j6Y_W; } goto vsM9v; MBYAY: $jrjyj = $this->pddbydlyj($share, $daytime, '', 1, $bl, $cfg); goto Aa4s8; DpTP4: qfyIP: goto x4Djj; ohYQN: moTc3: goto hI1yc; yEAPm: goto W4sWW; goto zbmVy; coQVj: if (!empty($jrygsum)) { goto k1cvq; } goto eEmea; aEGsh: weoYe: goto dFA8V; qG0qS: Zhkzc: goto xSclQ; sqL7Q: $wsysjyj = number_format($wsyrsjyj['yj3'], 2, '.', ''); goto lPsT8; WEXvK: mkLki: goto POPi7; lPsT8: $wsyzyj = $wsyygsum + $wsyrjyj + $wsysjyj; goto R3LXF; inghU: $rjyj = number_format($rsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto iAwnq; Oy87C: OCIU8: goto t53NI; WOZd5: msaBz: goto mBnbX; infnO: apCYY: goto aBY5E; v8HFW: vAbXn: goto Zi1bk; SL4jn: $rjyj = number_format($rsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto TUGGr; Ba46c: if ($bl['dltype'] == 2) { goto Zhkzc; } goto OCYWC; l0lJL: $syzyj = '0.00'; goto gOMT4; ck13a: Ux1_4: goto wRVCp; GH6s2: IfYYF: goto cusFq; SeyOA: fWxmj: goto eNgXr; WS193: goto Lsl2W; goto DpTP4; XEhl3: $wsysjyj = '0.00'; goto ZbZF5; UrrdQ: H3loS: goto x4MBl; aaLGw: if (!empty($zjrzyj)) { goto i7XFJ; } goto u2NE8; sLLsz: $byygsum = '0.00'; goto GH6s2; FiIoD: $wsyrjyj = number_format($wsyrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2); goto IfEJ7; dqXed: if ($bl['dltype'] == 3) { goto TLsBh; } goto YvIVN; Ywelf: $jryj = number_format($jrjyj['yj2'], 2, '.', ''); goto Mupfb; IqwDt: if (!empty($syrjyj)) { goto fWxmj; } goto iwTbv; BRgmm: $bbegin_time = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto uU_JN; uCbFq: $jrzyj = '0.00'; goto U1Mtx; zEyjV: if ($bl['dltype'] == 2) { goto TWUMt; } goto FeZEM; UhSI9: $wsyygsum = $this->pddbryj($share, $sbegin_time, $send_time, 1, $bl, $cfg); goto eXb_k; Xpul7: if (!empty($syzyj)) { goto kM0O3; } goto An23M; An23M: $syzyj = '0.00'; goto TybH0; fL3RK: if (!empty($syygsum)) { goto ZqA1i; } goto P_v7Q; TCj0D: $fs = $this->jcbl($share, $bl); goto xIZzC; CsFRI: $array = array("zong" => $zjrzyj, "s1" => $syzyj, "s2" => $syygsum, "s3" => $syrjyj, "s4" => $sysjyj, "s5" => $wsyzyj, "s6" => $wsyygsum, "s7" => $wsyrjyj, "s8" => $wsysjyj, "b1" => $brzyj, "b2" => $byygsum, "b3" => $rjyj, "b4" => $sjyj, "d1" => $brzfkyj, "d2" => $byfksum, "d3" => $rjfkyj, "d4" => $sjfkyj, "z1" => $zrzyj, "z2" => $zrygsum, "z3" => $zrrjyj, "z4" => $zrsjyj, "j1" => $jrzyj, "j2" => $jrygsum, "j3" => $jryj, "j4" => $jrsjyj); goto JtcAS; R2_Pm: $zrrsjyj = $this->pddbydlyj($share, $zttime, $daytime, 1, $bl, $cfg); goto FRpkK; WntfQ: if (!empty($jrzyj)) { goto Xdyq0; } goto Smnhg; CE8Ga: TdNPL: goto FiIoD; hSNTY: j6Y_W: goto XhC6m; ko0wS: if (!empty($brzfkyj)) { goto ICYIl; } goto PS5h4; x4MBl: $jryj = number_format($jrjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto qeOvd; Aa4s8: if ($bl['fxtype'] == 1) { goto O01El; } goto wPP1G; rUZG2: $sysjyj = '0.00'; goto v8HFW; sPi7v: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto wVnGm; akxBJ: if ($bl['fxtype'] == 1) { goto qfyIP; } goto Ba46c; uvJ4B: goto Vxcub; goto r3t1y; nCnFf: goto jVaLR; goto ooSXR; wPP1G: if ($bl['dltype'] == 2) { goto mkLki; } goto x2W6G; R3LXF: oDdVS: goto aaLGw; X30ly: TLsBh: goto inghU; ga6po: itjsJ: goto KSwSC; V2PSg: $zrzyj = $zrygsum + $zrrjyj + $zrsjyj; goto zWXXY; QCkvB: SafDm: goto Ix5xy; T1Q4M: $zrzyj = '0.00'; goto ck13a; OrzGn: nrMgx: goto SL4jn; FXe1o: cQKnW: goto IpYXA; c0Tdt: $brzfkyj = $byfksum + $rjfkyj + $sjfkyj; goto FCc8C; xSclQ: $rjfkyj = number_format($rsjfkyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto QTqgt; FRpkK: if ($bl['fxtype'] == 1) { goto winsE; } goto o7Dk5; xnZHQ: winsE: goto osiR9; TyaUL: } public function pddbydlyj($share = "", $begin_time = "", $end_time = "", $zt = "", $bl = "", $cfg = "", $sd = 0) { goto ypk64; bBL3Q: $array = array("yj2" => $rjrs * $bl['dlbl2'] / 100, "yj3" => $sjrs * $bl['dlbl3'] / 100); goto vPAxZ; vPi85: $sjrs = '0.00'; goto t0rtD; GjRW2: $addtime = 'order_pay_time'; goto TCP_4; uorrg: $r = ''; goto C_ARx; xJwAT: lAqHV: goto eGk2i; BkSrK: if ($send_time == $end_time) { goto ew_Vh; } goto ikvkY; fVuDZ: xDngH: goto BkSrK; jqOe2: $bl['dlbl1'] = $share['dlbl']; goto TsQDO; H6ttX: $addtime = 'order_pay_time'; goto dbFQb; IO9zQ: $where = "and order_pay_time>={$begin_time}"; goto Z7oYh; GtV5B: $rjrs = '0.00'; goto vPi85; rI78D: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto f0zme; J1drY: psFq8: goto PLE3D; bXmgm: $addtime = 'order_pay_time'; goto SvcVC; cgLjA: if (!($zt == 1)) { goto y3_zl; } goto bXmgm; DDsLP: if (empty($bl['dlkcbl'])) { goto oNo1v; } goto KLZK9; vPAxZ: return $array; goto oNH7q; uDw4Z: if (empty($begin_time)) { goto sfM2N; } goto IO9zQ; eq5Xt: if (empty($end_time)) { goto CRcub; } goto vtF4x; hI1py: $rjrs = $rjrs * (100 - $bl['dlkcbl']) / 100; goto Zb148; FMT31: KVJXE: goto ivFDK; pMj6x: goto hK82K; goto KeWrH; jrm1o: oNL3R: goto sfJFI; eGk2i: goto zOPvA; goto m3567; z__sZ: $rjrs = $r; goto bGeAw; JSvBA: gDFF9: goto z__sZ; PLE3D: if (!($sd == 1)) { goto ahVyq; } goto QyZxp; kMcmk: VcMQw: goto zkaJ2; bgDD3: $addtime = 'order_receive_time'; goto jHtE_; KeWrH: zNEzY: goto B2Jva; Fyvvr: $rjshare = pdo_fetchall('SELECT id,helpid,pddpid FROM ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and helpid='{$share['id']}' and dltype=1"); goto uorrg; Otpr4: if (empty($fans1)) { goto g2J1q; } goto wkbwd; r75CL: if (!empty($sjrs)) { goto HCgL0; } goto uG0E1; SflnS: $addtime = 'order_receive_time'; goto H4oLt; SvcVC: y3_zl: goto J1drY; sfJFI: $bbegin_time = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto Fyvvr; uG0E1: $sjrs = '0.00'; goto hO3mE; dbFQb: goto jikt5; goto V8So4; vVwNH: if (empty($share['dlbl'])) { goto bjAr4; } goto jqOe2; ivFDK: if ($zt == 2) { goto WCtPz; } goto H6ttX; V8So4: WCtPz: goto bgDD3; YkcaF: if (!($bl['dltype'] == 1)) { goto GEswD; } goto GtV5B; BgDa3: $sjrs = '0.00'; goto pMj6x; psDjn: if (!empty($rjrs)) { goto VcMQw; } goto r6L9O; dcsXL: goto oNL3R; goto ZPKqj; r6L9O: $rjrs = '0.00'; goto kMcmk; KRppo: $addtime = 'order_pay_time'; goto PKFEX; gcDk7: $ddzt = ' and (order_status_desc=\'已成团\' || order_status_desc=\'审核通过\')'; goto dcsXL; luhna: hK82K: goto YkcaF; Z7oYh: sfM2N: goto PB_hi; C_ARx: foreach ($rjshare as $k => $v) { goto JjttL; IvRYG: $r = $r + $a; goto fDNzG; fDNzG: JN0Zb: goto sF6Ij; JjttL: $a = pdo_fetchcolumn('SELECT sum(promotion_amount) FROM ' . tablename('tiger_newhu_pddorder') . "  where weid='{$_W['uniacid']}' and p_id='{$v['pddpid']}' {$ddzt} {$where}"); goto IvRYG; sF6Ij: } goto JSvBA; H4oLt: goto Vg6_R; goto FMT31; kqN7C: $where = "and {$addtime}>={$begin_time} and {$addtime}<{$end_time}"; goto xJwAT; f0zme: if ($cfg['jsms'] == 1) { goto xDngH; } goto KRppo; t235y: $ddzt = ' and (order_status_desc=\'确认收货\' || order_status_desc=\'已结算\')'; goto jrm1o; wkbwd: $sjrs = pdo_fetchcolumn('SELECT sum(t.promotion_amount) FROM ' . tablename('tiger_newhu_share') . ' s left join ' . tablename('tiger_newhu_pddorder') . " t ON s.pddpid=t.p_id where s.weid='{$_W['uniacid']}'   and s.dltype=1  {$ddzt} and s.helpid in (" . implode(',', array_keys($fans1)) . ") {$where}"); goto yVICd; TsQDO: bjAr4: goto rI78D; Zb148: QyuSm: goto psDjn; bb85e: ew_Vh: goto SflnS; PKFEX: goto psFq8; goto fVuDZ; m3567: CRcub: goto uDw4Z; ZPKqj: W5746: goto t235y; Y2u1N: oNo1v: goto r75CL; bpXG2: Vg6_R: goto cgLjA; vtF4x: if (empty($begin_time)) { goto lAqHV; } goto kqN7C; jHtE_: jikt5: goto bpXG2; QyZxp: $addtime = 'order_receive_time'; goto GcoY_; PB_hi: zOPvA: goto vX6aP; TCP_4: goto Vg6_R; goto bb85e; vX6aP: if ($zt == 2) { goto W5746; } goto gcDk7; ypk64: global $_W; goto vVwNH; zkaJ2: if ($bl['dltype'] == 3) { goto zNEzY; } goto BgDa3; t0rtD: GEswD: goto bBL3Q; KLZK9: $sjrs = $sjrs * (100 - $bl['dlkcbl']) / 100; goto Y2u1N; B2Jva: $fans1 = pdo_fetchall('select id from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and dltype=1 and helpid='{$share['id']}'", array(), 'id'); goto Otpr4; bGeAw: if (empty($bl['dlkcbl'])) { goto QyuSm; } goto hI1py; yVICd: g2J1q: goto DDsLP; hO3mE: HCgL0: goto luhna; GcoY_: ahVyq: goto eq5Xt; ikvkY: if ($begin_time == $bbegin_time1 and $end_time == $bend_time1) { goto KVJXE; } goto GjRW2; oNH7q: } public function pddbryj($share, $begin_time, $end_time, $zt, $bl, $cfg, $sd = 0) { goto oZ3Oa; hhPFJ: if (!($sd == 1)) { goto xqZMp; } goto kotpm; l_wH0: $byygsum = $yj2 - $yj1; goto tjPyb; nNN2e: $addtime = 'order_pay_time'; goto jO0a6; yt_GC: if ($cfg['jsms'] == 1) { goto hDlHl; } goto nNN2e; Y1r44: $yj1 = $yj2 * $bl['dlbl1t2'] / 100; goto l_wH0; IusKo: aDSyx: goto O5uQ3; V_20B: $byygsum = '0.00'; goto oBnGo; fIjI6: $sj2 = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$sj['helpid']}'"); goto M3Ijg; g6F2Z: s7m7v: goto l1n1O; cX_Cw: hg7TQ: goto H3qag; D4JdK: if ($begin_time == $bbegin_time1 and $end_time == $bend_time1) { goto bs_2j; } goto e7FNs; QLYDP: zFt82: goto Ayb3D; w0TgZ: $byygsum = $byygsum * $bl['dlbl1'] / 100; goto DSbzY; E8dPs: $dwhere = "and order_pay_time>={$begin_time}"; goto QDEIV; zqrOY: X0YZj: goto gRDhH; O5uQ3: if (empty($byygsum)) { goto MtKsU; } goto kftj1; BuEbz: iPNnZ: goto XyANa; oBnGo: yuN2d: goto qLcQ1; tjPyb: goto X0YZj; goto ksxHP; z12QU: nETqI: goto fIjI6; jO0a6: goto hLh6z; goto cIN7z; H3qag: $addtime = 'order_receive_time'; goto eIFln; s20xG: xqZMp: goto k0uBH; bhB5M: $byygsum = $byygsum * (100 - $bl['dlkcbl']) / 100; goto IusKo; ERDd6: if ($dj == 2) { goto dxDuE; } goto lohHE; ZQfts: $dj = 2; goto YtSKc; Pq9XB: if ($zt == 2) { goto WBl6U; } goto V0OKO; DvWyF: $dj = 1; goto z12QU; KsRhH: aCUH_: goto I_g4y; HI7sQ: $ddzt = ' and (order_status_desc=\'已成团\' || order_status_desc=\'审核通过\')'; goto pyScf; pyScf: goto yWwo0; goto BuEbz; BFmMR: $yj2 = $byygsum * $bl['dlbl2'] / 100; goto Y1r44; lohHE: $byygsum = $byygsum * $bl['dlbl1'] / 100; goto lOR0m; Pe01v: $bend_time1 = strtotime(date('Y-m-d H:i:s', mktime(23, 59, 59, date('m'), date('t'), date('Y')))); goto yt_GC; CDlUA: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto Tctw7; cIN7z: hDlHl: goto rLs6E; GV4Dv: $dwhere = "and {$addtime}>={$begin_time} and {$addtime}<{$end_time}"; goto PUjJj; Tctw7: $bbegin_time1 = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto Pe01v; UQInE: cv2x9: goto ZQfts; qLcQ1: if ($bl['fxtype'] == 1) { goto vmVHt; } goto uICmH; omeGS: $bl['dlbl1'] = $share['dlbl']; goto jG4Za; Izud4: goto fTS8e; goto zJJzR; zFvYV: if (empty($share['dlbl'])) { goto MhEGS; } goto omeGS; V0OKO: $addtime = 'order_pay_time'; goto Izud4; dKAG0: bs_2j: goto Pq9XB; ezcqB: $where = " and p_id='{$share['pddpid']}'"; goto bcoDD; qc5h7: goto aCUH_; goto cX_Cw; SmJ6F: if (empty($sj)) { goto m0K6p; } goto Rdh8X; uDZ6e: goto yuN2d; goto tO7f1; EGSNq: $addtime = 'order_receive_time'; goto zO1z2; srfVj: ksIhG: goto BFmMR; PUjJj: JjiGg: goto TP2_z; QDEIV: WlnwM: goto rEM1C; zJJzR: WBl6U: goto EGSNq; gRDhH: goto cQ1nx; goto Q6RmY; Rdh8X: if (!($bl['dltype'] == 2)) { goto nETqI; } goto DvWyF; bcoDD: $byygsum = pdo_fetchcolumn('SELECT sum(promotion_amount) FROM ' . tablename('tiger_newhu_pddorder') . " where weid='{$_W['uniacid']}'  {$ddzt} {$dwhere} {$where}"); goto uSIKo; k0uBH: if (empty($end_time)) { goto s7m7v; } goto NhVKh; zO1z2: fTS8e: goto KsRhH; Eqr2j: $byygsum = $yj3 - $yj2 - $yj1; goto zqrOY; Omb3w: goto nAMrX; goto UQInE; xcKtq: if ($zt == 2) { goto iPNnZ; } goto HI7sQ; GauuU: m0K6p: goto uDZ6e; DSbzY: cQ1nx: goto fBIDM; xUCNX: if (!empty($sj2)) { goto cv2x9; } goto DCjxg; bFc71: $addtime = 'order_pay_time'; goto QLYDP; tO7f1: MtKsU: goto V_20B; rEM1C: rS10a: goto xcKtq; M3Ijg: if (!($bl['dltype'] == 3)) { goto nEMZG; } goto xUCNX; ksxHP: dxDuE: goto s4qRX; jG4Za: MhEGS: goto CDlUA; kftj1: $sj = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$share['helpid']}'"); goto SmJ6F; uICmH: if ($dj == 1) { goto ksIhG; } goto ERDd6; l1n1O: if (empty($begin_time)) { goto WlnwM; } goto E8dPs; Q6RmY: vmVHt: goto w0TgZ; rLs6E: if ($send_time == $end_time) { goto hg7TQ; } goto D4JdK; OlZRY: $yj2 = $yj3 * $bl['dlbl2t3'] / 100; goto eGUwA; fBIDM: return $byygsum; goto IqkMU; wZMLP: yWwo0: goto ezcqB; TP2_z: goto rS10a; goto g6F2Z; rsjfZ: nEMZG: goto GauuU; eGUwA: $yj1 = $yj3 * $bl['dlbl1t3'] / 100; goto Eqr2j; lOR0m: goto X0YZj; goto srfVj; DCjxg: $dj = 1; goto Omb3w; s4qRX: $yj3 = $byygsum * $bl['dlbl3'] / 100; goto OlZRY; I_g4y: if (!($zt == 1)) { goto zFt82; } goto bFc71; uSIKo: if (empty($bl['dlkcbl'])) { goto aDSyx; } goto bhB5M; XyANa: $ddzt = ' and (order_status_desc=\'确认收货\' || order_status_desc=\'已结算\')'; goto wZMLP; Ayb3D: hLh6z: goto hhPFJ; YtSKc: nAMrX: goto rsjfZ; kotpm: $addtime = 'order_receive_time'; goto s20xG; e7FNs: $addtime = 'order_pay_time'; goto qc5h7; oZ3Oa: global $_W; goto zFvYV; NhVKh: if (empty($begin_time)) { goto JjiGg; } goto GV4Dv; eIFln: goto aCUH_; goto dKAG0; IqkMU: } public function bryj($share, $begin_time, $end_time, $zt, $bl, $cfg, $sd = 0) { goto DZf2j; rpUKE: $byygsum = '0.00'; goto oFdpR; xs9jc: goto oEbCI; goto ifNUx; g5GFu: $dj = 1; goto m4ysZ; vqR5D: if ($send_time == $end_time) { goto f2tsR; } goto F09Xq; eAVE4: goto qPOqw; goto mjrDq; C5yQM: oEbCI: goto mXqPv; rnY40: $dwhere = "and {$addtime}>={$begin_time} and {$addtime}<{$end_time}"; goto CrNGp; T4gJO: hJOH9: goto vqR5D; RuutQ: if (!empty($sj2)) { goto PbDGb; } goto g5GFu; dChBe: $addtime = 'addtime'; goto sG10V; kOg3I: goto BqGP9; goto NLcPr; WJqSN: s9M2g: goto wbR_z; ydynV: goto tJEU_; goto Pxpbu; J6ADA: BELV4: goto VJ_eo; h0g19: $ddzt = ' and orderzt=\'订单结算\''; goto lW6Sl; dx27p: rY43f: goto P_kfA; XWrI7: if (!($bl['dltype'] == 3)) { goto Y8gfr; } goto RuutQ; lyJDB: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto wnJ9v; n_UWC: wxOLp: goto kIP9b; KA9dg: $dj = 2; goto dx27p; IsLVB: EfQ8B: goto phy1I; m4ysZ: goto rY43f; goto YNLES; sk3O6: $where = ''; goto Xia8U; oFdpR: Ztns9: goto urWvx; ifNUx: f2tsR: goto aKXS_; P04L8: $yj2 = $yj3 * $bl['dlbl2t3'] / 100; goto GIPth; krJCp: goto oEbCI; goto IsLVB; coEwZ: GBS7a: goto BJQTM; VKs9g: BQD_h: goto SRaS_; wAlK3: goto BqGP9; goto VKs9g; uY_oB: tnYSy: goto rpUKE; eBvQO: goto GBS7a; goto n_UWC; mXqPv: if (!($zt == 2)) { goto lEM81; } goto dChBe; sqiRO: q4iiZ: goto InoEY; F09Xq: if ($begin_time == $bbegin_time1 and $end_time == $bend_time1) { goto EfQ8B; } goto YH1_O; MQHQm: tJEU_: goto nyUk9; VJ_eo: qk0E4: goto Ru3iu; b916M: $bend_time1 = strtotime(date('Y-m-d H:i:s', mktime(23, 59, 59, date('m'), date('t'), date('Y')))); goto hcW8e; RFX66: $ddzt = ' and orderzt<>\'订单失效\''; goto w0OGZ; Ru3iu: if ($zt == 1) { goto xpAwV; } goto IP5JM; nyUk9: $byygsum = pdo_fetchcolumn('SELECT sum(xgyg) FROM ' . tablename('tiger_newhu_tkorder') . " where weid='{$_W['uniacid']}'  {$ddzt} {$dwhere} {$where}"); goto hyBiC; byI9a: $addtime = 'addtime'; goto f93zA; GLSvT: $sj = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$share['helpid']}'"); goto ptnNY; Pxpbu: PDYkg: goto IEZ_6; aKXS_: $addtime = 'jstime'; goto krJCp; tAaVD: goto qk0E4; goto pvePT; h2dTo: $dwhere = "and addtime>={$begin_time}"; goto J6ADA; e1Yt3: if (empty($share['dlbl'])) { goto h_mO0; } goto FwP3w; BJQTM: return $byygsum; goto fJY3k; H3q5c: $byygsum = $byygsum * (100 - $bl['dlkcbl']) / 100; goto sqiRO; RYQGR: h_mO0: goto lyJDB; pvePT: W7urJ: goto HvVMO; hyBiC: if (empty($bl['dlkcbl'])) { goto q4iiZ; } goto H3q5c; lW6Sl: goto BeLTD; goto idOqs; phy1I: if ($zt == 1) { goto bqwxt; } goto EJtOy; uzwad: BqGP9: goto eBvQO; GIPth: $yj1 = $yj3 * $bl['dlbl1t3'] / 100; goto owfDC; XXwwC: goto BeLTD; goto xCLsh; hmgbx: $addtime = 'jstime'; goto VavUz; mjrDq: bqwxt: goto hmgbx; KPOIY: $yj2 = $byygsum * $bl['dlbl2'] / 100; goto aKBD6; YNLES: PbDGb: goto KA9dg; NLcPr: b4jwb: goto KPOIY; CX8HI: if ($dj == 1) { goto b4jwb; } goto RC5xM; sG10V: lEM81: goto qXs7I; RC5xM: if ($dj == 2) { goto BQD_h; } goto Tj16I; FwP3w: $bl['dlbl1'] = $share['dlbl']; goto RYQGR; SRaS_: $yj3 = $byygsum * $bl['dlbl3'] / 100; goto P04L8; rvSce: if (!($sd == 1)) { goto s9M2g; } goto kdrXV; bOUXC: h7g8L: goto N8Nze; hcW8e: if ($cfg['jsms'] == 1) { goto hJOH9; } goto byI9a; kIP9b: $byygsum = $byygsum * $bl['dlbl1'] / 100; goto coEwZ; IEZ_6: $where = " and tgwid='{$share['tgwid']}'"; goto MQHQm; Xia8U: if (empty($share['qdid'])) { goto PDYkg; } goto yVqEg; wbR_z: if (empty($end_time)) { goto W7urJ; } goto YfGxY; J1n1D: xpAwV: goto h0g19; VavUz: qPOqw: goto C5yQM; s4UJZ: $ddzt = ' and orderzt=\'订单付款\''; goto XXwwC; aKBD6: $yj1 = $yj2 * $bl['dlbl1t2'] / 100; goto V420e; qrm1j: if ($zt == 3) { goto zMyFW; } goto eGM13; eGM13: goto BeLTD; goto J1n1D; YfGxY: if (empty($begin_time)) { goto tVjz1; } goto rnY40; V420e: $byygsum = $yj2 - $yj1; goto wAlK3; xCLsh: zMyFW: goto RFX66; P_kfA: Y8gfr: goto embSS; DZf2j: global $_W; goto e1Yt3; kdrXV: $addtime = 'jstime'; goto WJqSN; owfDC: $byygsum = $yj3 - $yj2 - $yj1; goto uzwad; Tj16I: $byygsum = $byygsum * $bl['dlbl1'] / 100; goto kOg3I; hXjBl: $dj = 1; goto bOUXC; embSS: FaMPC: goto z_B1b; YH1_O: $addtime = 'addtime'; goto xs9jc; Bnud7: if (!($bl['dltype'] == 2)) { goto h7g8L; } goto hXjBl; wnJ9v: $bbegin_time1 = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto b916M; yVqEg: $where = " and  (tgwid='{$share['tgwid']}' || relation_id='{$share['qdid']}') "; goto ydynV; w0OGZ: BeLTD: goto sk3O6; ptnNY: if (empty($sj)) { goto FaMPC; } goto Bnud7; idOqs: hPjF0: goto s4UJZ; EJtOy: $addtime = 'addtime'; goto eAVE4; qXs7I: GmOsB: goto rvSce; IP5JM: if ($zt == 2) { goto hPjF0; } goto qrm1j; f93zA: goto GmOsB; goto T4gJO; CrNGp: tVjz1: goto tAaVD; urWvx: if ($bl['fxtype'] == 1) { goto wxOLp; } goto CX8HI; z_B1b: goto Ztns9; goto uY_oB; N8Nze: $sj2 = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$sj['helpid']}'"); goto XWrI7; InoEY: if (empty($byygsum)) { goto tnYSy; } goto GLSvT; HvVMO: if (empty($begin_time)) { goto BELV4; } goto h2dTo; fJY3k: } public function seachyj($share, $sbegin_time, $send_time, $zt, $bl, $cfg) { goto Zadmv; k_GLe: ETbUF: goto ybP_z; Zadmv: $syygsum = $this->bryj($share, $sbegin_time, $send_time, 1, $bl, $cfg, 1); goto s6YNp; Ta0KP: if ($bl['dltype'] == 3) { goto K0nsE; } goto RKn0T; OFwba: JeKk0: goto lIJCn; HnGE4: $syrsjyj = $this->bydlyj($share, $sbegin_time, $send_time, 1, $bl, $cfg, 1); goto PtTY_; EHV88: $sysjyj = number_format($syrsjyj['yj3'], 2, '.', ''); goto ukeBu; ybP_z: $syzyj = $syygsum + $syrjyj + $sysjyj; goto pfpIW; ukeBu: $syzyj = $syygsum + $syrjyj + $sysjyj; goto OFwba; pfpIW: goto JeKk0; goto DnfMv; uxFkP: IYC6t: goto OWsp7; pEtu8: return $data; goto NsF6m; s6YNp: $syygsum = number_format($syygsum, 2, '.', ''); goto HnGE4; amXdq: K0nsE: goto tLGAP; EUZkN: $data = array("s1" => $syzyj, "s2" => $syygsum, "s3" => $syrjyj, "s4" => $sysjyj); goto pEtu8; PtTY_: if ($bl['fxtype'] == 1) { goto hOquc; } goto f62Vm; pEdCD: $syzyj = '0.00'; goto x6b0G; tLGAP: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl2t3'] / 100, 2, '.', ''); goto vl4Wa; vl4Wa: $sysjyj = number_format($syrsjyj['yj3'] * $bl['dlbl1t3'] / 100, 2, '.', ''); goto k_GLe; f62Vm: if ($bl['dltype'] == 2) { goto IYC6t; } goto Ta0KP; DnfMv: hOquc: goto HqmZh; OWsp7: $syrjyj = number_format($syrsjyj['yj2'] * $bl['dlbl1t2'] / 100, 2, '.', ''); goto DhvgS; RKn0T: goto ETbUF; goto uxFkP; lIJCn: if (!empty($syzyj)) { goto yupm3; } goto pEdCD; DhvgS: goto ETbUF; goto amXdq; HqmZh: $syrjyj = number_format($syrsjyj['yj2'], 2, '.', ''); goto EHV88; x6b0G: yupm3: goto EUZkN; NsF6m: } public function jcbl($share, $bl) { goto ggUNy; Vc72l: $djbl = $bl['dlbl1']; goto sCywU; IOXN9: goto pgK9Q; goto acEYA; B4Vsm: $cj = 1; goto IOXN9; P_BSE: $sj = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$share['helpid']}'"); goto V5EFl; jsIT9: $cj = 1; goto R31yS; aiSZh: $djbl = $share['dlbl']; goto o43hU; ggUNy: global $_W; goto P_BSE; FuGy7: F12NK: goto jaOG1; Bh__q: $tname = $bl['dlname2']; goto R85kN; Q6edX: SetD2: goto xgwIQ; CZBUF: if (empty($share['dlbl'])) { goto SetD2; } goto aiSZh; t2nE_: if (!empty($sj2)) { goto Jh5pP; } goto LN3Px; lrRzY: goto F12NK; goto lucuZ; RLGQv: Jh5pP: goto zJPWQ; xfEC_: $tname = $bl['dlname3']; goto l9Md3; MZ30o: j2FUY: goto JhCYT; bDLMA: return $arr; goto VwZR9; RJerd: E4Swi: goto wmvH1; R31yS: goto E4Swi; goto MZ30o; JhCYT: $sj2 = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$sj['helpid']}'"); goto t2nE_; gildV: $cj = 1; goto lrRzY; zJPWQ: $djbl = $bl['dlbl3']; goto xfEC_; jaOG1: pgK9Q: goto CZBUF; tc2AG: $cj = 2; goto asLqF; f522G: $djbl = $bl['dlbl2']; goto Bh__q; acEYA: gqNYK: goto co2un; LN3Px: $djbl = $bl['dlbl2']; goto NNB0C; NNB0C: $tname = $bl['dlname2']; goto tc2AG; R85kN: $cj = 2; goto FuGy7; nymf9: $tname = $bl['dlname1']; goto jsIT9; puUnN: if (!empty($sj)) { goto D1SY9; } goto CqBk4; u04Q1: R0FhR: goto RJerd; lucuZ: D1SY9: goto f522G; wmvH1: goto pgK9Q; goto NYzCE; xgwIQ: $arr = array("bl" => $djbl, "tname" => $tname, "cj" => $cj); goto bDLMA; co2un: if (!empty($sj)) { goto j2FUY; } goto NNCGl; V5EFl: if ($bl['dltype'] == 3) { goto gqNYK; } goto ht_Wi; asLqF: goto R0FhR; goto RLGQv; o43hU: $tname = $bl['dlname1']; goto Q6edX; NNCGl: $djbl = $bl['dlbl1']; goto nymf9; NYzCE: yQQ1t: goto puUnN; sCywU: $tname = $bl['dlname1']; goto B4Vsm; b1VNm: $tname = $bl['dlname1']; goto gildV; l9Md3: $cj = 3; goto u04Q1; ht_Wi: if ($bl['dltype'] == 2) { goto yQQ1t; } goto Vc72l; CqBk4: $djbl = $bl['dlbl1']; goto b1VNm; VwZR9: } public function bydlyj($share = "", $begin_time = "", $end_time = "", $zt = "", $bl = "", $cfg = "", $sd = 0) { goto f1HkO; SKOYL: e3FI4: goto uHIyH; gIAiE: g3Qr0: goto KNC5D; NTtOe: if (empty($bl['dlkcbl'])) { goto OEeWd; } goto TOal4; nfk_7: $where = "and addtime>={$begin_time}"; goto S_zv2; wdeza: if ($bl['dltype'] == 3) { goto qFfVb; } goto USUE0; pAXNN: jxFGW: goto NC2qh; amK2O: JxnPL: goto wzjd_; deFY3: $addtime = 'addtime'; goto N8P2H; xWJph: $sjrs = pdo_fetchcolumn('SELECT sum(t.xgyg) FROM ' . tablename('tiger_newhu_share') . ' s left join ' . tablename('tiger_newhu_tkorder') . " t ON s.tgwid=t.tgwid where s.weid='{$_W['uniacid']}'   and s.dltype=1  {$ddzt} and s.helpid in (" . implode(',', array_keys($fans1)) . ") {$where}"); goto Ropok; KNC5D: $ddzt = ' and orderzt=\'订单结算\''; goto t40N1; TOal4: $rjrs = $rjrs * (100 - $bl['dlkcbl']) / 100; goto Ct586; hQUQ3: G4HSL: goto sLCDG; SiDtD: $addtime = 'addtime'; goto e5Znk; QLBoy: $addtime = 'jstime'; goto oxgP_; ueC76: if (!empty($sjrs)) { goto OzavS; } goto wjfTy; BoBoQ: if (!($bl['dltype'] == 1)) { goto bRZwp; } goto r4GUz; gD5rG: HFuXt: goto M1viE; ici9I: $sjrs = '0.00'; goto balEe; fCsxs: $addtime = 'addtime'; goto u2l3M; psVSG: $rjrs = $r; goto NTtOe; kx0z1: $rjrs = '0.00'; goto Y3osi; cNJxV: $addtime = 'jstime'; goto gD5rG; SgB8J: if ($zt == 2) { goto KGMml; } goto ZEIyw; NBPJS: A4cVz: goto ueC76; X_rtl: goto jxFGW; goto gIAiE; t40N1: goto jxFGW; goto yHLxt; NC2qh: $bbegin_time = strtotime(date('Y-m-d H:i:s', mktime(0, 0, 0, date('m'), 1, date('Y')))); goto Bp_v0; M1viE: if (!($zt == 2)) { goto pI425; } goto deFY3; hN6GN: if (empty($begin_time)) { goto M165U; } goto nfk_7; wEn6K: if ($cfg['jsms'] == 1) { goto JxnPL; } goto fCsxs; N8P2H: pI425: goto oYh_a; RkWBV: $r = ''; goto GkD8F; a_Ucl: if (empty($share['dlbl'])) { goto G4HSL; } goto TtynJ; rtCO4: goto jxFGW; goto SKOYL; WMuqK: $where = "and {$addtime}>={$begin_time} and {$addtime}<{$end_time}"; goto o5hns; rvb44: goto Onc3p; goto ZMmQJ; oIzml: ifLPw: goto BoBoQ; Qk8gy: goto ifLPw; goto Nj2Cf; ZMmQJ: TeYjB: goto hN6GN; balEe: bRZwp: goto SPdz2; oxgP_: Prbu9: goto pNrVx; J920_: OzavS: goto oIzml; yHLxt: KGMml: goto ohYHN; f1HkO: global $_W; goto a_Ucl; wzjd_: if ($send_time == $end_time) { goto O26Ct; } goto SiDtD; Tt0d8: JHHFq: goto psVSG; P0SbH: O26Ct: goto cNJxV; NngKB: Onc3p: goto JUoDe; JUoDe: if ($zt == 1) { goto g3Qr0; } goto SgB8J; Ct586: OEeWd: goto lDuBc; gjGIu: $sjrs = $sjrs * (100 - $bl['dlkcbl']) / 100; goto NBPJS; lDuBc: if (!empty($rjrs)) { goto F95TG; } goto kx0z1; aUnwE: if (empty($fans1)) { goto Q2Jjl; } goto xWJph; GkD8F: foreach ($rjshare as $k => $v) { goto ZincR; U3Ow3: YKwFg: goto cWs79; ZincR: if (empty($v['qdid'])) { goto KN3cm; } goto NiIV4; fs1Gd: $a = pdo_fetchcolumn('SELECT sum(xgyg) FROM ' . tablename('tiger_newhu_tkorder') . "  where weid='{$_W['uniacid']}' and tgwid='{$v['tgwid']}' {$ddzt} {$where}"); goto Iulxy; NiIV4: $a = pdo_fetchcolumn('SELECT sum(xgyg) FROM ' . tablename('tiger_newhu_tkorder') . "  where weid='{$_W['uniacid']}' and (tgwid='{$v['tgwid']}' || relation_id='{$v['qdid']}' ) {$ddzt} {$where}"); goto R8wK6; N5br1: $r = $r + $a; goto U3Ow3; R8wK6: goto AK7ap; goto txt9t; txt9t: KN3cm: goto fs1Gd; Iulxy: AK7ap: goto N5br1; cWs79: } goto Tt0d8; ZEIyw: if ($zt == 3) { goto e3FI4; } goto X_rtl; sVk8q: if (!($sd == 1)) { goto Prbu9; } goto QLBoy; CFSx6: if (empty($bl['dlkcbl'])) { goto A4cVz; } goto gjGIu; SPdz2: $array = array("yj2" => $rjrs * $bl['dlbl2'] / 100, "yj3" => $sjrs * $bl['dlbl3'] / 100); goto gxlzv; Ropok: Q2Jjl: goto CFSx6; r4GUz: $rjrs = '0.00'; goto ici9I; Y3osi: F95TG: goto wdeza; sBDEo: $fans1 = pdo_fetchall('select id from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and dltype=1 and helpid='{$share['id']}'", array(), 'id'); goto aUnwE; USUE0: $sjrs = '0.00'; goto Qk8gy; o5hns: j_BJ6: goto rvb44; S_zv2: M165U: goto NngKB; wjfTy: $sjrs = '0.00'; goto J920_; oYh_a: jSzrp: goto sVk8q; ohYHN: $ddzt = ' and orderzt=\'订单付款\''; goto rtCO4; TtynJ: $bl['dlbl1'] = $share['dlbl']; goto hQUQ3; Bp_v0: $rjshare = pdo_fetchall('SELECT id,helpid,tgwid FROM ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and helpid='{$share['id']}' and dltype=1"); goto RkWBV; pNrVx: if (empty($end_time)) { goto TeYjB; } goto zE_0v; u2l3M: goto jSzrp; goto amK2O; gxlzv: return $array; goto WTAel; sLCDG: $send_time = strtotime(date('Y-m-d 23:59:59', strtotime(-date('d') . 'day'))); goto wEn6K; uHIyH: $ddzt = ' and orderzt<>\'订单失效\''; goto pAXNN; zE_0v: if (empty($begin_time)) { goto j_BJ6; } goto WMuqK; Nj2Cf: qFfVb: goto sBDEo; e5Znk: goto HFuXt; goto P0SbH; WTAel: } public function goodlist($key, $pid, $page, $dlbl, $bl) { goto gjTU2; MZsTb: $resp = $c->execute($req); goto aUiTv; k5p3R: $goods = $resp['results']['tbk_coupon']; goto YNW4c; gahRP: $req->setPlatform('2'); goto FKS2y; aUiTv: $resp = json_decode(json_encode($resp), TRUE); goto k5p3R; gjTU2: require_once IA_ROOT . '/addons/tiger_newhu/inc/sdk/getpic.php'; goto lln55; ES5Rc: $c->secretKey = $api['secretKey']; goto wmNmC; lln55: $api = taobaopp($tiger); goto GJgNd; WPsrA: $req->setQ($key); goto t6JBf; TBjbm: v46E1: goto fZ34S; wmNmC: $req = new TbkItemCouponGetRequest(); goto gahRP; zvWk1: $c->appkey = $api['appkey']; goto ES5Rc; t6JBf: $req->setPageNo($page); goto BWDZK; fZ34S: return $list; goto Z2Gg8; BWDZK: $req->setPid($pid); goto MZsTb; FKS2y: $req->setPageSize('20'); goto WPsrA; YNW4c: foreach ($goods as $k => $v) { goto oSWyN; cWXKH: $list[$k]['org_price'] = $v['zk_final_price']; goto rhtVA; oSWyN: $list[$k]['title'] = $v['title']; goto Zirb3; itzuU: $list[$k]['url'] = $v['coupon_click_url']; goto tZRJS; rhtVA: $list[$k]['pic_url'] = $v['pict_url']; goto ZhpiT; MQOem: $list[$k]['price'] = $xprc; goto otHTD; e1ruI: $xprc = $v['zk_final_price'] - $matches[2][0]; goto MQOem; anenK: if (empty($bl['dlkcbl'])) { goto y3CoD; } goto KkdGR; pJqIf: $list[$k]['nick'] = $v['nick']; goto q2sBa; otBMl: $list[$k]['dlyj'] = number_format($dlyj * $dlbl / 100, 2); goto cWXKH; otHTD: $dlyj = $v['commission_rate'] * $xprc / 100; goto anenK; Zirb3: $list[$k]['istmall'] = $v['user_type']; goto z8h3N; Plf8M: $list[$k]['coupons_total'] = $v['coupon_total_count']; goto H06Iw; tZRJS: $list[$k]['coupons_end'] = $v['coupon_end_time']; goto BJLVv; H06Iw: $list[$k]['item_url'] = $v['item_url']; goto NtV1L; BJLVv: preg_match_all('|满([\\d\\.]+).*元减([\\d\\.]+).*元|ism', $v['coupon_info'], $matches); goto jR1Lj; NtV1L: $list[$k]['small_images'] = $v['small_images']['string']; goto hEJQH; jR1Lj: $list[$k]['coupons_price'] = $matches[2][0]; goto hkPv_; hkPv_: $list[$k]['goods_sale'] = $v['volume']; goto e1ruI; nwb1x: PFZjJ: goto JHUVi; hEJQH: $list[$k]['pic_url'] = $v['pict_url']; goto nwb1x; KkdGR: $dlyj = $dlyj * (100 - $bl['dlkcbl']) / 100; goto Ph9AF; ZhpiT: $list[$k]['shop_title'] = $v['shop_title']; goto pJqIf; z8h3N: $list[$k]['num_iid'] = $v['num_iid']; goto itzuU; Ph9AF: y3CoD: goto otBMl; q2sBa: $list[$k]['coupons_take'] = $v['coupon_remain_count']; goto Plf8M; JHUVi: } goto TBjbm; GJgNd: $c = new TopClient(); goto zvWk1; Z2Gg8: } public function doMobileOpenlink() { goto rpHad; jfG9k: $cfg = $this->module['config']; goto BXXJa; rpHad: global $_W, $_GPC; goto Glwtp; Glwtp: $url = urldecode($_GPC['link']); goto jfG9k; BXXJa: include $this->template('openlink'); goto tPQjg; tPQjg: } public function dljiangli($endprice, $tkrate, $bl, $share) { goto DeaFk; YTNKF: vMdnh: goto xzxL2; T8Yl6: $jryj = 0; goto DR4GD; b4NiN: $jryj = $yj * $bl['dlbl1t2'] / 100; goto QRWdv; uxv9m: $jrsjyj = $yj * $bl['dlbl1t3'] / 100; goto IY6wq; mr9xz: tJJwD: goto wEY2W; qW6gu: Oihlg: goto wnkO7; lXtNo: goto VipBa; goto lZmxA; wnkO7: $jryj = 0; goto axxeZ; xzxL2: if (empty($share['helpid'])) { goto Oihlg; } goto Zojog; rN7Nb: E_zdK: goto XubDs; lZmxA: gKUjT: goto F4WcD; IY6wq: goto YEz5K; goto mr9xz; EDyUp: lzOcm: goto Jh8Pt; lgQ5F: return $dlrate; goto GEUDh; DR4GD: vzHCO: goto ZxbUm; Ko1GG: if (empty($bl['dlkcbl'])) { goto wS8Gs; } goto D_Ufq; Aa3i2: $yj = number_format($dlyj * $dlbl / 100, 2); goto SkUCP; SkUCP: if ($bl['dltype'] == 2) { goto lzOcm; } goto IlXC8; uURnN: if (empty($sjshare['helpid'])) { goto tJJwD; } goto uxv9m; VHYrJ: $dlyj = $endprice * $tkrate / 100; goto Ko1GG; IlXC8: if ($bl['dltype'] == 3) { goto vMdnh; } goto pVAwQ; XubDs: $jrzyj = $yj - $jryj - $jrsjyj; goto golHg; skIy9: $dlbl = $fs['bl']; goto lXtNo; Jh8Pt: if (empty($share['helpid'])) { goto ySlnM; } goto b4NiN; rAnCg: OVX1e: goto lgQ5F; ZxbUm: goto E_zdK; goto YTNKF; QRWdv: goto vzHCO; goto MYRt3; zL2eg: $dlrate = number_format($dlyj * $dlbl / 100, 2); goto rAnCg; pAM2z: VipBa: goto vBc1c; uSzMC: $fs = $this->jcbl($share, $bl); goto URmVJ; wEY2W: $jrsjyj = 0; goto xoHe3; xoHe3: YEz5K: goto DPPQm; URmVJ: if (empty($share['dlbl'])) { goto gKUjT; } goto skIy9; DeaFk: global $_W; goto VHYrJ; DPPQm: goto WFzCM; goto qW6gu; golHg: file_put_contents(IA_ROOT . '/addons/tiger_tkxcx/yj_log.txt', '
' . 'uid:' . $share['id'] . '------' . $yj . '-' . $jryj . '-' . $jrsjyj . '=' . $jrzyj, FILE_APPEND); goto qPmSU; D_Ufq: $dlyj = $dlyj * (100 - $bl['dlkcbl']) / 100; goto PwhUu; s1EEV: BrReL: goto zL2eg; qPmSU: $dlrate = number_format($jrzyj, 2); goto hMF9q; F4WcD: $dlbl = $bl['dlbl1']; goto pAM2z; MYRt3: ySlnM: goto T8Yl6; PwhUu: wS8Gs: goto uSzMC; hMF9q: goto OVX1e; goto s1EEV; Zojog: $sjshare = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$share['weid']}'and dltype=1 and id='{$share['helpid']}'"); goto c6VP5; pVAwQ: goto E_zdK; goto EDyUp; c6VP5: $jryj = $yj * $bl['dlbl2t3'] / 100; goto uURnN; axxeZ: WFzCM: goto rN7Nb; vBc1c: if ($bl['fxtype'] == 1) { goto BrReL; } goto Aa3i2; GEUDh: } public function tkl($url, $img, $tjcontent) { goto asUHt; Z4a83: $req->setExt('{}'); goto Glbz_; Z2UIZ: $req->setText($tjcontent); goto SDxOv; UqGGs: $c->appkey = $appkey; goto Li1ra; D2r4Q: $req = new TbkTpwdCreateRequest(); goto Z2UIZ; S370h: $jsonStr = json_encode($resp); goto PNICn; PNICn: $jsonArray = json_decode($jsonStr, true); goto PGtYZ; zTtCD: $cfg = $this->module['config']; goto VIUc9; BT879: if (empty($zcfg['tklleft'])) { goto X5DVg; } goto A4qpZ; SHdC2: $secret = $cfg['tksecretKey']; goto hEakL; PGtYZ: $taokou = $jsonArray['data']['model']; goto pYWMf; A4qpZ: $taokou = str_replace('￥', '', $taokou); goto Egpqt; asUHt: global $_W, $_GPC; goto gEjEW; o07fc: $zcfg = unserialize($s['settings']); goto zTtCD; yrQa0: $taokou = str_replace('《', '￥', $taokou); goto EOGH0; V0BTC: X5DVg: goto Unz6u; OZ9vT: $req->setLogo($img); goto Z4a83; hEakL: $c = new TopClient(); goto UqGGs; Li1ra: $c->secretKey = $secret; goto D2r4Q; DKfe9: $s = pdo_fetch('select settings from ' . tablename('uni_account_modules') . " where module='tiger_newhu' and uniacid='{$weid}'"); goto o07fc; SDxOv: $req->setUrl($url); goto OZ9vT; VIUc9: $appkey = $cfg['tkAppKey']; goto SHdC2; gEjEW: $weid = $_W['uniacid']; goto DKfe9; pYWMf: if (!($cfg['tklnewtype'] == 1)) { goto OE6Di; } goto yrQa0; Glbz_: $resp = $c->execute($req); goto S370h; Unz6u: return $taokou; goto i27RV; EOGH0: OE6Di: goto BT879; Egpqt: $taokou = $zcfg['tklleft'] . $taokou . $zcfg['tklright']; goto V0BTC; i27RV: } public function dwz($url) { goto AmfEq; ApXEa: if ($cfg['dwzlj'] == 0) { goto bWHAt; } goto x1Cmd; y_TWR: bWHAt: goto E8Mhg; AmfEq: global $_W; goto Qtip_; E8Mhg: $url = $this->sinadwz($turl); goto fd9xq; x1Cmd: if ($cfg['dwzlj'] == 1) { goto D76jI; } goto k_7OS; Qtip_: $cfg = $this->module['config']; goto j5M5x; PKiJj: $url = $this->wxdwz($turl); goto zMupq; zMupq: I62jn: goto T3d3r; sghJO: goto I62jn; goto y_TWR; DyEQK: D76jI: goto PKiJj; j5M5x: $url = urlencode($url); goto UgYv7; UgYv7: $turl = $_W['siteroot'] . '/app/index.php?i=' . $_W['uniacid'] . '&c=entry&do=openlink&m=tiger_newhu&link=' . $url; goto ApXEa; k_7OS: $urlarr = $this->zydwz($turl); goto sghJO; fd9xq: goto I62jn; goto DyEQK; T3d3r: } public function dwzw($turl) { goto PqXy3; gwOHI: goto cw6X3; goto VDaT6; C1PZQ: goto cw6X3; goto tUgLA; uOnVr: $url = $this->sinadwz($turl); goto C1PZQ; D8qBo: $cfg = $this->module['config']; goto C_IID; Hmlva: cw6X3: goto p5bQw; p5bQw: return $url; goto NGdk5; m0soZ: if ($cfg['dwzlj'] == 1) { goto XmE2E; } goto Qr3NZ; PqXy3: global $_W; goto D8qBo; C_IID: if ($cfg['dwzlj'] == 0) { goto fCySm; } goto m0soZ; wyGtC: $url = $this->wxdwz($turl); goto Hmlva; tUgLA: XmE2E: goto wyGtC; Qr3NZ: $url = $this->zydwz($turl); goto gwOHI; VDaT6: fCySm: goto uOnVr; NGdk5: } public function zydwz($turl) { goto FbBzu; k9ljH: $cfg = $this->module['config']; goto XWriy; WYrow: $url = $cfg['zydwz'] . 't.php?d=' . $id; goto ia4By; XXu3q: pdo_insert('tiger_newhu_dwz', $data); goto UxiV4; FbBzu: global $_W; goto k9ljH; ia4By: return $url; goto SLQJl; XWriy: $data = array("weid" => $_W['uniacid'], "url" => $turl, "createtime" => TIMESTAMP); goto XXu3q; UxiV4: $id = pdo_insertid(); goto WYrow; SLQJl: } public function wxdwz($url) { goto SY5zT; Qbww4: $ret = ihttp_request($url, $result); goto eEgYP; Komqv: $access_token = $this->getAccessToken(); goto hUNYQ; hUNYQ: $url = "https://api.weixin.qq.com/cgi-bin/shorturl?access_token={$access_token}"; goto Qbww4; SY5zT: $result = '{"action":"long2short","long_url":"' . $url . '"}'; goto Komqv; cPx4B: return $content['short_url']; goto RG3e3; eEgYP: $content = @json_decode($ret['content'], true); goto cPx4B; RG3e3: } public function sinadwz($url) { goto wBufG; WujHU: return $result[0]['url_short']; goto Ugp9F; Zo6AS: goto Up6O1; goto tSUZp; hGZCV: file_put_contents(IA_ROOT . '/addons/tiger_newhu/log--sina.txt', '
--3' . $url, FILE_APPEND); goto e2F0K; wI0Rd: $key = '1549359964'; goto I5sOx; vXuJe: $cfg = $this->module['config']; goto YtsRa; tSUZp: uVqxl: goto wI0Rd; R72a1: load()->func('communication'); goto k7oXl; eFN96: $result = @json_decode($json['content'], true); goto WujHU; I2e61: $key = trim($cfg['sinkey']); goto Zo6AS; I5sOx: Up6O1: goto pn3vQ; e2F0K: file_put_contents(IA_ROOT . '/addons/tiger_newhu/log--sina.txt', '
--3' . json_encode($json), FILE_APPEND); goto eFN96; pn3vQ: $turl2 = urlencode($url); goto L85D5; YtsRa: if (empty($cfg['sinkey'])) { goto uVqxl; } goto I2e61; L85D5: $sinaurl = "http://api.t.sina.com.cn/short_url/shorten.json?source={$key}&url_long={$turl2}"; goto R72a1; wBufG: global $_W; goto vXuJe; k7oXl: $json = ihttp_get($sinaurl); goto hGZCV; Ugp9F: } public function getAccessToken() { goto qY_fk; HsUds: if (!empty($acid)) { goto SMH7z; } goto cKlqR; qY_fk: global $_W; goto sQOdi; ANpmP: include IA_ROOT . '/addons/tiger_wxdaili/wxtoken.php'; goto BusCn; gwFAA: SMH7z: goto ANpmP; r08ki: $acid = $_W['acid']; goto HsUds; BusCn: return $token; goto EWiiP; cKlqR: $acid = $_W['uniacid']; goto gwFAA; sQOdi: load()->model('account'); goto r08ki; EWiiP: } public function mygetID($url) { goto JxLFs; m7paq: bO86s: goto eJAE0; sLdZj: oYypb: goto dYMHw; JxLFs: if (preg_match('/[\\?&]id=(\\d+)/', $url, $match)) { goto bO86s; } goto iuE9r; nWSZR: goto oYypb; goto m7paq; iuE9r: return ''; goto nWSZR; eJAE0: return $match[1]; goto sLdZj; dYMHw: } public function getyouhui2($str) { preg_match_all('|(￥[^￥]+￥)|ism', $str, $matches); return $matches[1][0]; } public function geturl($str) { goto Eit6b; iPx0q: $url = 'http' . trim($exp[1]) . ' '; goto pXvqA; sRl8p: C1WfL: goto c0XzB; nPVdE: $url = substr($url, 0, $matches[0][1]); goto du8Om; du8Om: if ($url == 'http') { goto C1WfL; } goto ZJo6O; ZJo6O: return $url; goto gdvlm; c0XzB: return ''; goto IhTnt; gdvlm: goto XCI4n; goto sRl8p; IhTnt: XCI4n: goto RyG55; Eit6b: $exp = explode('http', $str); goto iPx0q; pXvqA: preg_match('/[\\s]/u', $url, $matches, PREG_OFFSET_CAPTURE); goto nPVdE; RyG55: } public function myisexists($url) { goto ZnC0w; ie0Vf: goto Vmit8; goto hRzYz; RwBbb: return 1; goto tQ6Cd; hRzYz: Q6ks6: goto xFX11; YSrly: return 0; goto UChdO; tQ6Cd: goto Vmit8; goto GPH1k; ZnC0w: if (stripos($url, 'taobao.com') !== false) { goto smLPL; } goto Oi3nT; YX6Si: Vmit8: goto YSrly; nb3CG: if (stripos($url, 'tmall.hk') !== false) { goto wLdHU; } goto RwBbb; GPH1k: smLPL: goto RiHha; NfDFE: return 2; goto YX6Si; IbeaZ: goto Vmit8; goto T0_B1; RiHha: return 2; goto ie0Vf; xFX11: return 2; goto IbeaZ; Oi3nT: if (stripos($url, 'tmall.com') !== false) { goto Q6ks6; } goto nb3CG; T0_B1: wLdHU: goto NfDFE; UChdO: } public function hqgoodsid($url) { goto SY0zR; U1iX5: $goodsid = $this->Text_qzj($str, '&id=', '&'); goto UuwXB; UuwXB: J8OLs: goto Y_gxV; j2TAE: $url = $this->Text_qzj($str, 'url = \'', '\';'); goto wCtDe; sVlrZ: return $goodsid; goto swrFH; JmOYT: yZj9q: goto xc_s9; wCtDe: $goodsid = $this->Text_qzj($str, 'com/i', '.htm'); goto JmOYT; v6BsX: $goodsid = $this->Text_qzj($str, 'itemid=', '&'); goto HNzsE; ys3Im: $goodsid = $this->Text_qzj($str, 'itemId=', '&'); goto utPhF; qzlY4: $goodsid = $this->Text_qzj($str, 'itemId:', ','); goto EP8NQ; lNxqP: $goodsid = $this->Text_qzj($str, '?id=', '&'); goto If9uO; xc_s9: if (!empty($goodsid)) { goto lU7cd; } goto v6BsX; Uqtkc: if (!empty($goodsid)) { goto yZj9q; } goto j2TAE; EP8NQ: XUuAt: goto Uqtkc; Y_gxV: if (!empty($goodsid)) { goto XUuAt; } goto qzlY4; If9uO: if (!empty($goodsid)) { goto J8OLs; } goto U1iX5; hsgg0: $str = str_replace('"', '', $str); goto lNxqP; SY0zR: $str = $this->curl_request($url); goto hsgg0; RhAv6: if (!empty($goodsid)) { goto vtBX0; } goto ys3Im; HNzsE: lU7cd: goto RhAv6; utPhF: vtBX0: goto sVlrZ; swrFH: } public function curl_request($url, $post = "", $cookie = "", $returnCookie = 0) { goto PAPfr; k97Ie: $data = curl_exec($curl); goto Go2zI; qpE2x: curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); goto Zh6ed; PK_81: AGy57: goto a84Cn; c3UXP: curl_setopt($curl, CURLOPT_POSTFIELDS, http_build_query($post)); goto v8ZFR; ryIm8: curl_setopt($curl, CURLOPT_HEADER, $returnCookie); goto EXEun; owA3z: if (!$post) { goto Hw5jN; } goto lPNeE; Dtb9c: $info['content'] = $body; goto S72Ec; Zh6ed: curl_setopt($curl, CURLOPT_AUTOREFERER, 1); goto lEXqt; EXEun: curl_setopt($curl, CURLOPT_TIMEOUT, 10); goto IvB3q; R03Jx: $info['cookie'] = substr($matches[1][0], 1); goto Dtb9c; IvB3q: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto k97Ie; v8ZFR: Hw5jN: goto eYmGP; PAPfr: $curl = curl_init(); goto wLJM4; Gl5B0: preg_match_all('/Set\\-Cookie:([^;]*);/', $header, $matches); goto R03Jx; EfH3W: curl_close($curl); goto r90pt; S72Ec: return $info; goto U4DeD; Go2zI: if (!curl_errno($curl)) { goto hOXAv; } goto VBXPv; eSMPq: curl_setopt($curl, CURLOPT_COOKIE, $cookie); goto IhxOq; VBXPv: return curl_error($curl); goto RBOXm; eYmGP: if (!$cookie) { goto m7WXN; } goto eSMPq; r90pt: if ($returnCookie) { goto AGy57; } goto WM0iz; U4DeD: DCdJH: goto F4S4v; lPNeE: curl_setopt($curl, CURLOPT_POST, 1); goto c3UXP; lEXqt: curl_setopt($curl, CURLOPT_REFERER, 'http://XXX'); goto owA3z; WM0iz: return $data; goto Ximxh; IhxOq: m7WXN: goto ryIm8; F5vZI: curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; 	Trident/6.0)'); goto qpE2x; RBOXm: hOXAv: goto EfH3W; a84Cn: list($header, $body) = explode('

', $data, 2); goto Gl5B0; Ximxh: goto DCdJH; goto PK_81; wLJM4: curl_setopt($curl, CURLOPT_URL, $url); goto F5vZI; F4S4v: } public function Text_qzj($Text, $Front, $behind) { goto FAvyw; jf0fj: fPj0c: goto RTRZz; GQ3xN: return ''; goto U5x0r; z9Gdl: $t2 = mb_strpos($temp, $behind); goto VG0u1; mwT_N: if ($t1 == FALSE) { goto BtwWd; } goto bmvQU; vy6Tj: BtwWd: goto GQ3xN; JmaEL: return ''; goto jf0fj; joG4N: $temp = mb_substr($Text, $t1, strlen($Text) - $t1); goto z9Gdl; bmvQU: $t1 = $t1 - 1 + strlen($Front); goto eEaP3; VG0u1: if (!($t2 == FALSE)) { goto fPj0c; } goto JmaEL; FAvyw: $t1 = mb_strpos('.' . $Text, $Front); goto mwT_N; eEaP3: goto LRhrb; goto vy6Tj; U5x0r: LRhrb: goto joG4N; RTRZz: return mb_substr($temp, 0, $t2); goto f2gG7; f2gG7: } public function mbmsg($openid = "", $mb = "", $mbid = "", $url = "", $fans = "", $orderid = "", $cfg = "", $valuedata = "") { goto pIDG5; ckgP9: $mb['first'] = str_replace('#昵称#', $fans['nickname'], $mb['first']); goto SuRYc; t5Znh: $tp_color1 = unserialize($mb['zjcolor']); goto FSpcA; s_QLu: YGRgP: goto t5Znh; mala9: $mb['remark'] = str_replace('#订单号#', $orderid, $mb['remark']); goto ep_0F; iGbTJ: $tp_value1 = str_replace('#订单号#', $orderid, $tp_value1); goto THBBj; THBBj: if (empty($valuedata)) { goto YGRgP; } goto v_UP2; ObdJV: $mb['remark'] = str_replace('#昵称#', $fans['nickname'], $mb['remark']); goto mala9; eEjKC: $tp_value1 = str_replace('#微信号#', $valuedata['weixin'], $tp_value1); goto CagY0; bjDVA: $tp_value1 = str_replace('#申请代理理由#', $valuedata['dlmsg'], $tp_value1); goto iNH4Z; zFm2r: return $msg; goto UAHYu; v_UP2: $tp_value1 = str_replace('#提现金额#', $valuedata['rmb'], $tp_value1); goto VATbu; Eutqd: AWcFA: goto zs4Wr; eiygz: $tp_value1 = str_replace('#昵称#', $fans['nickname'], $tp_value1); goto iGbTJ; FSpcA: $mb['first'] = str_replace('#时间#', date('Y-m-d H:i:s', time()), $mb['first']); goto ckgP9; Ys2td: $tp_value1 = unserialize($mb['zjvalue']); goto NRDyo; CTa3b: if (empty($valuedata['dlsqjj'])) { goto saHrr; } goto aJRPC; iNH4Z: $tp_value1 = str_replace('#代理申请人姓名#', $valuedata['tname'], $tp_value1); goto CTa3b; pIDG5: global $_W; goto Ys2td; ep_0F: $tplist1['remark'] = array("value" => $mb['remark'], "color" => $mb['remarkcolor']); goto mr_VE; CagY0: $tp_value1 = str_replace('#手机号#', $valuedata['tel'], $tp_value1); goto bjDVA; Thbrf: $tplist1 = array("first" => array("value" => $mb['first'], "color" => $mb['firstcolor'])); goto BF1Aa; aJRPC: $tp_value1 = str_replace('#代理申请拒绝原因#', $valuedata['dlsqjj'], $tp_value1); goto HeB0D; mr_VE: $msg = $this->sendMsg($openid, $mbid, $tplist1, '', $url); goto zFm2r; SuRYc: $mb['first'] = str_replace('#订单号#', $orderid, $mb['first']); goto Thbrf; zs4Wr: $mb['remark'] = str_replace('#时间#', date('Y-m-d H:i:s', time()), $mb['remark']); goto ObdJV; BF1Aa: foreach ($tp_value1 as $key => $value) { goto uioXl; PnvFc: $tplist1['keyword' . $key] = array("value" => $value, "color" => $tp_color1[$key]); goto F12hu; N6LP3: goto xJHdy; goto a0rby; uioXl: if (!empty($value)) { goto Greqx; } goto N6LP3; F12hu: xJHdy: goto vUvT7; a0rby: Greqx: goto PnvFc; vUvT7: } goto Eutqd; VATbu: $tp_value1 = str_replace('#提现账号#', $valuedata['txzhanghao'], $tp_value1); goto eEjKC; NRDyo: $tp_value1 = str_replace('#时间#', date('Y-m-d H:i:s', time()), $tp_value1); goto eiygz; HeB0D: saHrr: goto s_QLu; UAHYu: } public function sendMsg($openid = "", $tplmsgid = "", $data = array(), $data1 = "", $url = "") { goto eE_U4; tR05T: include IA_ROOT . '/addons/tiger_wxdaili/wxtoken.php'; goto Z1bV9; dy8fF: $cfg = $this->module['config']; goto tR05T; Z1bV9: return $account->sendTplNotice($openid, $tplmsgid, $data, $url); goto B43fI; eE_U4: global $_W; goto dy8fF; B43fI: } public function doMobileGetpay() { goto MuO1g; HSkQA: TuGNr: goto KH2_X; NDRRi: $tel = $_GPC['tel']; goto y1fch; m3n2b: die(json_encode($result)); goto c5gJr; E1BAd: $uid = $_GPC['uid']; goto zzLJS; v0H0u: if (!empty($share)) { goto TuGNr; } goto wD31q; MuO1g: global $_GPC, $_W; goto nu13s; c5gJr: fy_5u: goto jRze9; KH2_X: $usernames = $_GPC['tname']; goto NDRRi; wD31q: $result = array("errcode" => 1, "errmsg" => "用户信息不存在2"); goto cUzFm; BkzJy: $price = $_GPC['price']; goto v0H0u; OMj2y: die(json_encode($result)); goto CB4Ih; zzLJS: if (!empty($uid)) { goto fy_5u; } goto r4oWo; y1fch: $weixin = $_GPC['weixin']; goto KBddq; rkyhs: $result = $this->unifiedPay($share, $desc, $fee, '55555555'); goto OMj2y; nu13s: file_put_contents(IA_ROOT . '/addons/tiger_wxdaili/log1.txt', '
 dddo1ld:' . json_encode($_GPC), FILE_APPEND); goto e3rxr; e3rxr: $cfg = $this->module['config']; goto E1BAd; Bp3zb: $bl = pdo_fetch('select * from ' . tablename('tiger_wxdaili_set') . " where weid='{$_W['uniacid']}'"); goto fkH5I; jjQPw: $desc = $share['nickname'] . $_GPC['tname'] . '代理费用'; goto Bp3zb; jRze9: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$uid}'"); goto BkzJy; cUzFm: die(json_encode($result)); goto HSkQA; r4oWo: $result = array("errcode" => 1, "errmsg" => "用户信息不存在1"); goto m3n2b; fkH5I: $fee = floatval($bl['dlffprice']); goto rkyhs; KBddq: $dlmsg = $_GPC['dlmsg']; goto jjQPw; CB4Ih: } public function doMobileCheckjspayresult() { goto o39TF; iRuc_: $cfg = $this->module['config']; goto BeC7m; Dwcfy: $result = $this->dealpayresult($order['orderno'], $_GPC); goto gMLHG; BeC7m: $share = pdo_fetch('select * from ' . tablename('tiger_newhu_share') . " where weid='{$_W['uniacid']}' and id='{$_GPC['uid']}'"); goto L5dK_; hLzTH: $order = pdo_fetch('SELECT orderno FROM ' . tablename($this->modulename . '_order') . " WHERE id = '{$orderid}' "); goto Dwcfy; KBk1T: WOIUH: goto jvOxv; jvOxv: die(json_encode($result)); goto htB7p; gMLHG: if (!($cfg['zdshtype'] == 1)) { goto WOIUH; } goto VuMjy; MZa2V: $orderid = $_GPC['orderid']; goto hLzTH; L5dK_: file_put_contents(IA_ROOT . '/addons/tiger_wxdaili/log.txt', '
 dddo1ld:' . json_encode($_GPC) . '---' . $share['id'] . '---' . $cfg['glyopenid'], FILE_APPEND); goto jzsSB; VuMjy: $this->dlzdsh($share['id'], $share, $cfg['glyopenid'], $cfg); goto KBk1T; jzsSB: $orderno = $_GPC['orderno']; goto MZa2V; o39TF: global $_GPC, $_W; goto iRuc_; htB7p: } public function randorder() { goto qWsQf; I2BTE: $basecode = (double) sprintf('%.0f', (floatval($t1) + floatval($t2)) * 1000); goto DRJlo; qWsQf: list($t1, $t2) = explode(' ', microtime()); goto I2BTE; DRJlo: return date('YmdHis') . substr($basecode, 2, 10) . mt_rand(1000, 9999); goto WAErL; WAErL: } public function unifiedPay($member, $desc, $fee, $goods_id) { goto goiqc; aPtDM: k3ACO: goto KFEW6; gj64S: $system = $this->module['config']; goto JfoMN; a9aZx: $trade_type = 'JSAPI'; goto xE9zT; FX44S: $orderno = $this->randorder(); goto a9aZx; ySrMM: libxml_disable_entity_loader(true); goto N6JXk; xE9zT: $thisappid = $_W['account']['key']; goto Au8iW; Q5gRd: return $result; goto bJsBj; PmF0E: $result = array("errcode" => 0, "auth" => 0, "timeStamp" => $params['timeStamp'], "nonceStr" => $params['nonceStr'], "package" => $params['package'], "signType" => $params['signType'], "paySign" => $params['paySign'], "orderno" => $orderno, "orderid" => $orderid); goto Q5gRd; E6oNp: $post['sign'] = strtoupper($sign); goto Vj6tr; goiqc: global $_W; goto gj64S; CxadS: $sign = md5($string); goto E6oNp; KFEW6: return array("errcode" => 1, "errmsg" => $resp['return_msg']); goto ZDd1m; vDJLP: if ($resp['result_code'] != 'SUCCESS') { goto k3ACO; } goto PPLqC; whACv: $string .= "&key={$system['apikey']}"; goto CxadS; PPLqC: $orderid = $this->addOrder($member, $post, $goods_id); goto dw9rk; ZDd1m: agd4y: goto cADJW; Au8iW: $post = array("appid" => $system['appid'], "mch_id" => $system['mchid'], "nonce_str" => $random, "body" => $desc, "out_trade_no" => $orderno, "total_fee" => $fee * 100, "spbill_create_ip" => $system['ip'], "notify_url" => 'http://' . $_SERVER['HTTP_HOST'] . '/payment/wechat/pay.php', "trade_type" => $trade_type, "openid" => $member['from_user']); goto PJvuK; PJvuK: ksort($post); goto pemhb; JfoMN: $url = 'https://api.mch.weixin.qq.com/pay/unifiedorder'; goto yseSY; Vj6tr: $resp = $this->postXmlCurl($this->ToXml($post), $url); goto ySrMM; N6JXk: $resp = json_decode(json_encode(simplexml_load_string($resp, 'SimpleXMLElement', LIBXML_NOCDATA)), true); goto vDJLP; bJsBj: goto agd4y; goto aPtDM; dw9rk: $params = $this->getWxPayJsParams($resp['prepay_id']); goto PmF0E; pemhb: $string = $this->ToUrlParams($post); goto whACv; yseSY: $random = random(8); goto FX44S; cADJW: } public function addOrder($member, $post, $goods_id) { goto ixB7e; esHcN: $data = array("weid" => $_W['uniacid'], "orderno" => $post['out_trade_no'], "goods_id" => $goods_id, "price" => $fee, "memberid" => $member['id'], "openid" => $member['from_user'], "nickname" => $member['nickname'], "avatar" => $member['avatar'], "tel" => $member['tel'], "cengji" => 0, "usernames" => $member['nickname'], "msg" => $member['nickname'] . '代理费用', "createtime" => time()); goto Yv7d8; SQtxk: $orderid = pdo_insertid(); goto E3Ier; ixB7e: global $_W; goto vANz2; E3Ier: return $orderid; goto sQY21; Yv7d8: pdo_insert($this->modulename . '_order', $data); goto SQtxk; vANz2: $fee = $post['total_fee'] / 100; goto esHcN; sQY21: } public function dldealpayresult($orderno, $gpc) { goto eO9RY; jJIPo: Wl2Ur: goto GBRS0; K6ukH: $result['errmsg'] = '订单号为空'; goto NlewA; xtGyh: wWjzx: goto AZ_TW; G0CKK: $ores = pdo_update($this->modulename . '_order', $data, array("id" => $order['id'])); goto hex9m; ZZIQ4: pdo_update('tiger_newhu_share', $dldata, array("weid" => $_W['uniacid'], "id" => $order['memberid'])); goto C_pRP; LSH_G: $mbid = $cfg['dlsqtx']; goto zIO61; iVb0M: $result['url'] = $url; goto GuGYF; C_pRP: $cfg = $this->module['config']; goto Dlvd5; AZ_TW: $this->jiangli($order['openid'], $order); goto G0CKK; Xtup3: $result['msg'] = '支付成功!'; goto iVb0M; J9u7T: $msg = $this->mbmsg($cfg['glyopenid'], $mb, $mb['mbid'], $mb['turl'], $fans, ''); goto IT6Qy; JAHWA: if (!($order['paystate'] == 0)) { goto s6I3w; } goto Rps6G; lCmlX: return $result; goto rlQCY; XukTU: D8gGU: goto ay8yc; MlwsI: $checkresult = $this->checkWechatTranByOrderNo($orderno); goto G63Se; YBYF0: $url = ''; goto cPBak; GuGYF: D8sPr: goto O7kYT; N0PcU: $data['state'] = 1; goto xtGyh; Rps6G: $data = array("paystate" => 1, "paytime" => time()); goto Ck_U7; eO9RY: global $_W; goto BKLrk; k0MQy: goto D8sPr; goto XukTU; GBRS0: $result['errcode'] = 1; goto K6ukH; VnRT7: if (empty($orderno)) { goto Wl2Ur; } goto MlwsI; Muqxe: $result['errcode'] = 1; goto aZz7T; BKLrk: $result = array(); goto VnRT7; aZz7T: $result['errmsg'] = $checkresult['errmsg']; goto k0MQy; ay8yc: $order = pdo_fetch('SELECT * FROM ' . tablename($this->modulename . '_order') . " WHERE  weid = '{$_W['uniacid']}' and orderno ='{$orderno}'"); goto JAHWA; NlewA: mvbHU: goto lCmlX; zIO61: $mb = pdo_fetch('select * from ' . tablename('tiger_newhu_mobanmsg') . " where weid='{$_W['uniacid']}' and id='{$mbid}'"); goto J9u7T; Ck_U7: if (!($order['state'] == 0)) { goto wWjzx; } goto N0PcU; cPBak: $result['errcode'] = 0; goto Xtup3; Dlvd5: if (empty($cfg['dlsqtx'])) { goto GdzWe; } goto LSH_G; hex9m: $dldata = array("helpid" => 0, "tztype" => 1, "tzpaytime" => time(), "tztime" => time(), "tzendtime" => time() + $order['tzday'] * 24 * 60 * 60); goto ZZIQ4; IT6Qy: GdzWe: goto Ifi2h; G63Se: if ($checkresult['errcode'] == 0) { goto D8gGU; } goto Muqxe; Ifi2h: s6I3w: goto YBYF0; O7kYT: goto mvbHU; goto jJIPo; rlQCY: } public function dealpayresult($orderno, $gpc) { goto q8ZbV; JsZS7: THM8V: goto bqTze; pAwhF: $this->jiangli($order['openid'], $order); goto cSglP; Y430_: a7LlO: goto UqxhG; cIMid: $msg = $this->mbmsg($cfg['glyopenid'], $mb, $mb['mbid'], $mb['turl'], $fans, ''); goto QwuBJ; ZMGfn: YIRjR: goto DKrgB; gF3qq: $result['errcode'] = 1; goto eYroR; rZRpA: if (empty($cfg['dlsqtx'])) { goto bdE97; } goto kY0IL; q8ZbV: global $_W; goto xJYpI; gaZzU: goto a7LlO; goto nsZo_; i7Uz8: $result['msg'] = '支付成功!'; goto oirwJ; QwuBJ: bdE97: goto ZMGfn; eYroR: $result['errmsg'] = $checkresult['errmsg']; goto GtQvs; mPD0r: $checkresult = $this->checkWechatTranByOrderNo($orderno); goto IpOx5; YbCJk: if (!($order['paystate'] == 0)) { goto YIRjR; } goto WgTs1; UqxhG: return $result; goto L1xKt; hG_pK: $data['state'] = 1; goto EnIDW; GtQvs: goto cjU_n; goto JsZS7; zFnsH: $result['errmsg'] = '订单号为空'; goto Y430_; nsZo_: KD_mi: goto QmKAv; zB7uU: pdo_update('tiger_newhu_share', $dldata, array("weid" => $_W['uniacid'], "id" => $order['memberid'])); goto pAwhF; QmKAv: $result['errcode'] = 1; goto zFnsH; koVl0: cjU_n: goto gaZzU; kY0IL: $mbid = $cfg['dlsqtx']; goto r7DRM; meKaW: if (!($order['state'] == 0)) { goto Vg0Cq; } goto hG_pK; oirwJ: $result['url'] = $url; goto koVl0; r7DRM: $mb = pdo_fetch('select * from ' . tablename('tiger_newhu_mobanmsg') . " where weid='{$_W['uniacid']}' and id='{$mbid}'"); goto cIMid; xJYpI: $result = array(); goto PkMZo; PkMZo: if (empty($orderno)) { goto KD_mi; } goto mPD0r; DKrgB: $url = $_W['siteroot'] . 'app/' . $this->createMobileUrl('jiameng', array("goods_id" => $order['goods_id'])); goto qrfhU; WgTs1: $data = array("paystate" => 1, "paytime" => time()); goto meKaW; bqTze: $order = pdo_fetch('SELECT * FROM ' . tablename($this->modulename . '_order') . " WHERE  weid = '{$_W['uniacid']}' and orderno ='{$orderno}'"); goto YbCJk; SfITw: $dldata = array("weixin" => $gpc['weixin'], "tel" => $gpc['tel'], "pcuser" => $gpc['tel'], "pcpasswords" => $gpc['pcpasswords'], "dlmsg" => $gpc['dlmsg'], "tname" => $gpc['tname'], "zfbuid" => $gpc['zfbuid'], "dltype" => 2); goto zB7uU; qrfhU: $result['errcode'] = 0; goto i7Uz8; EnIDW: Vg0Cq: goto lLCFR; cSglP: $cfg = $this->module['config']; goto rZRpA; IpOx5: if ($checkresult['errcode'] == 0) { goto THM8V; } goto gF3qq; lLCFR: pdo_update($this->modulename . '_order', $data, array("id" => $order['id'])); goto SfITw; L1xKt: } public function jiangli($openid, $order) { goto Fg7Ii; MDBFb: xys3T: goto v3mov; cOhIn: if (!empty($bl['level1'])) { goto PYePe; } goto MuA7a; lHV93: file_put_contents(IA_ROOT . '/addons/tiger_wxdaili/log.txt', '
' . json_encode($uid . '--3--' . $data['price']), FILE_APPEND); goto Cuv88; MIUxj: if (empty($sjmember['from_user'])) { goto KCr1w; } goto QxrMh; mfE9d: $this->postText($member['from_user'], $msg0); goto xlqNZ; uumfG: $data['price'] = $bl['glevel2']; goto Qmd9A; AxEdT: pdo_insert($this->modulename . '_order', $data); goto MDBFb; TpmO6: $data['cengji'] = 2; goto Nr2PO; Syq_E: $data['avatar'] = $sjmember['avatar']; goto U3Zi1; KGeKv: goto i90Td; goto Mwh2v; CFEdV: $data['nickname'] = $smember['nickname']; goto cfQWy; V0yip: $msg3 = str_replace('#昵称#', $member['nickname'], $bl['zfmsg3']); goto ZcP0u; d0Q6h: nYCaz: goto lHV93; F6KbI: $msg0 = str_replace('#昵称#', $member['nickname'], $bl['zfmsg0']); goto TTJAW; Cuv88: HUM_p: goto Y8Jla; FdQC3: $data['memberid'] = $sjmember['id']; goto kI4Ol; tnYkL: $data['msg'] = $member['nickname'] . '一级奖励'; goto MIUxj; S5NIj: $smember = pdo_fetch('SELECT * FROM ' . tablename('tiger_newhu_share') . " WHERE id = '{$hmember['helpid']}' and weid='{$_W['uniacid']}' and dltype=1 order by id desc limit 1"); goto cOhIn; bVxgJ: $data['avatar'] = $hmember['avatar']; goto dRlND; qn7Av: uLJF0: goto PCWGc; Wpdle: $data['openid'] = $smember['from_user']; goto tUkSd; v3mov: KCr1w: goto gAios; rRkFg: if (empty($data['price'])) { goto zIqS0; } goto V0yip; F2j48: $cfg = $this->module['config']; goto rIc1L; wzBjF: oGGN3: goto ZsD0F; AvP0h: if (empty($hmember['openid'])) { goto rLq8n; } goto DgiYO; UxPLQ: $msg2 = str_replace('#昵称#', $member['nickname'], $bl['zfmsg2']); goto GKPB4; Mwh2v: lZNHm: goto WqBXv; ZsD0F: $data['memberid'] = $hmember['id']; goto MGdxx; xlqNZ: if (empty($member['helpid'])) { goto DEd01; } goto ku3Uu; dRlND: $data['openid'] = $hmember['from_user']; goto TpmO6; Titrh: $data['msg'] = $member['nickname'] . '三级奖励'; goto i1ut5; yO_Xn: $this->postText($smember['from_user'], $msg3); goto iYwdn; v0SrH: $msg1 = str_replace('#金额#', $data['price'], $msg1); goto Gq8Bo; M0SWJ: DEd01: goto f5pk1; As4zE: goto uLJF0; goto Qn9a9; MGdxx: $data['nickname'] = $hmember['nickname']; goto bVxgJ; MuA7a: $data['price'] = $bl['glevel3']; goto As4zE; KGmJL: load()->model('mc'); goto F2j48; PCWGc: $data['memberid'] = $smember['id']; goto CFEdV; oujB6: $hmember = pdo_fetch('SELECT * FROM ' . tablename('tiger_newhu_share') . " WHERE id = '{$sjmember['helpid']}' and weid='{$_W['uniacid']}' and dltype=1 order by id desc limit 1"); goto EhCdB; WqBXv: $data['price'] = $order['price'] * $bl['level1'] / 100; goto Msn5H; i8MfT: $data = array("weid" => $_W['uniacid'], "orderno" => $order['orderno'], "goods_id" => $order['goods_id'], "state" => 1, "paystate" => 1, "paytime" => $order['paytime'], "createtime" => time()); goto F6KbI; cfQWy: $data['avatar'] = $smember['avatar']; goto Wpdle; EhCdB: if (!empty($bl['level1'])) { goto yQZFS; } goto uumfG; uGmrG: pdo_insert($this->modulename . '_order', $data); goto vKDdk; GKPB4: $msg2 = str_replace('#金额#', $data['price'], $msg2); goto ie0Tt; Qmd9A: goto oGGN3; goto ef_Fe; gAios: if (empty($sjmember['helpid'])) { goto K_yS0; } goto oujB6; juU22: $data['price'] = $order['price'] * $bl['level2'] / 100; goto wzBjF; tUkSd: $data['cengji'] = 3; goto Titrh; WDw9u: $data['cengji'] = 1; goto tnYkL; vKDdk: P2Cjh: goto thKqF; NUTTQ: $data['price'] = $order['price'] * $bl['level3'] / 100; goto qn7Av; QxrMh: if (empty($data['price'])) { goto xys3T; } goto fIKl1; DgiYO: if (empty($data['price'])) { goto P2Cjh; } goto UxPLQ; thKqF: rLq8n: goto sqNu0; sSOKp: if (!empty($bl['level1'])) { goto lZNHm; } goto n1rOC; Y8Jla: K_yS0: goto M0SWJ; nLZpx: $this->mc_jl($sjmember['id'], 1, 10, $data['price'], $data['msg'], $order['orderno']); goto AxEdT; v44if: $member = pdo_fetch('SELECT * FROM ' . tablename('tiger_newhu_share') . " WHERE id = '{$order['memberid']}' and weid='{$_W['uniacid']}'"); goto i8MfT; Fg7Ii: global $_W; goto KGmJL; ie0Tt: $this->postText($hmember['from_user'], $msg2); goto xZ_mr; Qn9a9: PYePe: goto NUTTQ; n1rOC: $data['price'] = $bl['glevel1']; goto KGeKv; fIKl1: $msg1 = str_replace('#昵称#', $member['nickname'], $bl['zfmsg1']); goto v0SrH; sqNu0: if (empty($hmember['helpid'])) { goto HUM_p; } goto S5NIj; Gq8Bo: $this->postText($sjmember['from_user'], $msg1); goto nLZpx; rIc1L: $bl = pdo_fetch('select * from ' . tablename('tiger_wxdaili_set') . " where weid='{$_W['uniacid']}'"); goto v44if; i1ut5: if (empty($smember['openid'])) { goto nYCaz; } goto rRkFg; UcXJA: pdo_insert($this->modulename . '_order', $data); goto tJLaC; xZ_mr: $this->mc_jl($hmember['id'], 1, 10, $data['price'], $data['msg'], $order['orderno']); goto uGmrG; Nr2PO: $data['msg'] = $member['nickname'] . '二级奖励'; goto AvP0h; U3Zi1: $data['openid'] = $sjmember['from_user']; goto WDw9u; TTJAW: $msg0 = str_replace('#金额#', $order['price'], $msg0); goto mfE9d; kI4Ol: $data['nickname'] = $sjmember['nickname']; goto Syq_E; Msn5H: i90Td: goto FdQC3; tJLaC: zIqS0: goto d0Q6h; ku3Uu: $sjmember = pdo_fetch('SELECT * FROM ' . tablename('tiger_newhu_share') . " WHERE id = '{$member['helpid']}' and weid='{$_W['uniacid']}' and dltype=1"); goto sSOKp; iYwdn: $this->mc_jl($smember['id'], 1, 10, $data['price'], $data['msg'], $order['orderno']); goto UcXJA; ZcP0u: $msg3 = str_replace('#金额#', $data['price'], $msg3); goto yO_Xn; ef_Fe: yQZFS: goto juU22; f5pk1: } public function checkWechatTranByOrderNo($orderno) { goto BLRV2; P9vxQ: $post['sign'] = strtoupper($sign); goto VyjnV; AkiWM: y7YVo: goto xeRyB; Ps5qn: ksort($post); goto Czo1a; xsk3u: if ($resp['return_code'] == 'SUCCESS') { goto y7YVo; } goto Gp64l; Czo1a: $string = $this->ToUrlParams($post); goto KhlvB; jC4_h: $sign = md5($string); goto P9vxQ; VyjnV: $resp = $this->postXmlCurl($this->ToXml($post), $url); goto lI1oI; OYaAL: $post = array("appid" => $system['appid'], "out_trade_no" => $orderno, "nonce_str" => $random, "mch_id" => $system['mchid']); goto Ps5qn; qAS_D: return array("errcode" => 0, "fee" => $resp['total_fee'] / 100); goto ERPRQ; HiVjt: goto UVxK5; goto oDCCI; Gp64l: return array("errcode" => 1, "errmsg" => '查询失败:' . $resp['return_msg']); goto e6ssa; oDCCI: HgYM1: goto qAS_D; ERPRQ: UVxK5: goto A9cV4; YrpQd: $random = random(8); goto OYaAL; KhlvB: $string .= "&key={$system['apikey']}"; goto jC4_h; DLEHF: $system = $this->module['config']; goto zMoR0; lI1oI: libxml_disable_entity_loader(true); goto vNRrJ; Qc3vS: ij8pz: goto i2G4z; BLRV2: global $_W; goto DLEHF; e6ssa: goto ul8cM; goto AkiWM; zMoR0: $url = 'https://api.mch.weixin.qq.com/pay/orderquery'; goto YrpQd; UrPtc: ul8cM: goto wJ1GP; vNRrJ: $resp = json_decode(json_encode(simplexml_load_string($resp, 'SimpleXMLElement', LIBXML_NOCDATA)), true); goto xsk3u; jbrUa: return array("errcode" => 1, "errmsg" => '订单不存在' . $resp['err_code']); goto lIL9R; A9cV4: lY0Ok: goto UrPtc; xeRyB: if ($resp['result_code'] == 'SUCCESS') { goto ij8pz; } goto jbrUa; i2G4z: if ($resp['trade_state'] == 'SUCCESS') { goto HgYM1; } goto PF1Tw; PF1Tw: return array("errcode" => 1, "errmsg" => '未支付:' . $resp['trade_state']); goto HiVjt; lIL9R: goto lY0Ok; goto Qc3vS; wJ1GP: } public function ToUrlParams($urlObj) { goto kShay; BT9jn: DFBSl: goto v_wWM; kShay: $buff = ''; goto t4rGE; DNm1z: return $buff; goto TSif_; v_wWM: $buff = trim($buff, '&'); goto DNm1z; t4rGE: foreach ($urlObj as $k => $v) { goto TuFoV; RgDgK: c3jG6: goto n66WL; TuFoV: if (!($k != 'sign')) { goto t8O8G; } goto VPGe1; vaQ3D: t8O8G: goto RgDgK; VPGe1: $buff .= $k . '=' . $v . '&'; goto vaQ3D; n66WL: } goto BT9jn; TSif_: } public function postXmlCurl($xml, $url, $useCert = false, $second = 30) { goto rMDST; T3JgG: curl_setopt($ch, CURLOPT_HEADER, FALSE); goto Gbgfp; zT1pn: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'PEM'); goto pOgug; JPElO: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); goto T3JgG; zp_ZB: curl_setopt($ch, CURLOPT_POST, TRUE); goto eUdwG; Gbgfp: curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); goto YJkCW; LM8WV: curl_setopt($ch, CURLOPT_URL, $url); goto J70n5; yr4gV: curl_close($ch); goto izgyX; IOlFo: gC9Ui: goto c62ny; USZoF: if (!$data) { goto gC9Ui; } goto yr4gV; te1VA: curl_setopt($ch, CURLOPT_SSLKEY, WxPayConfig::SSLKEY_PATH); goto Yh18V; YJkCW: if (!($useCert == true)) { goto E21dg; } goto zT1pn; rMDST: $ch = curl_init(); goto FV88b; pOgug: curl_setopt($ch, CURLOPT_SSLCERT, WxPayConfig::SSLCERT_PATH); goto GbCBs; N1NQK: $data = curl_exec($ch); goto USZoF; GbCBs: curl_setopt($ch, CURLOPT_SSLKEYTYPE, 'PEM'); goto te1VA; eUdwG: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto N1NQK; FV88b: curl_setopt($ch, CURLOPT_TIMEOUT, $second); goto LM8WV; J70n5: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto JPElO; Yh18V: E21dg: goto zp_ZB; izgyX: return $data; goto IOlFo; c62ny: } public function ToXml($post) { goto WglQU; qD3i_: $xml .= '</xml>'; goto rwdUc; rwdUc: return $xml; goto goT3w; WglQU: $xml = '<xml>'; goto kPuzx; kPuzx: foreach ($post as $key => $val) { goto e2iZY; mMFjK: bFaO2: goto DlKY0; yXSyd: goto YzwEM; goto H41vC; ax66P: $xml .= '<' . $key . '><![CDATA[' . $val . ']]></' . $key . '>'; goto yXSyd; HvRSb: YzwEM: goto mMFjK; H41vC: wwoKB: goto GoUye; GoUye: $xml .= '<' . $key . '>' . $val . '</' . $key . '>'; goto HvRSb; e2iZY: if (is_numeric($val)) { goto wwoKB; } goto ax66P; DlKY0: } goto Mlt5m; Mlt5m: bAemZ: goto qD3i_; goT3w: } public function getWxPayJsParams($prepay_id) { goto LuN52; Y1n7j: $random = random(8); goto Udwz2; QO9TV: $post['paySign'] = strtoupper($sign); goto Z67Kv; LuN52: global $_W; goto F0d7B; F0d7B: $system = $this->module['config']; goto Y1n7j; Ckh8Z: $sign = md5($string); goto QO9TV; XYL_m: $string = $this->ToUrlParams($post); goto wAHmK; QuZzg: ksort($post); goto XYL_m; Udwz2: $post = array("appId" => $system['appid'], "timeStamp" => time(), "nonceStr" => $random, "package" => 'prepay_id=' . $prepay_id, "signType" => "MD5"); goto QuZzg; Z67Kv: return $post; goto l4i20; wAHmK: $string .= "&key={$system['apikey']}"; goto Ckh8Z; l4i20: } function post_txhb($cfg, $openid, $dtotal_amount, $desc, $dmch_billno) { goto tb3ue; TTTT8: $ret['message'] = $procResult; goto vGA5I; RLJ27: $ret['code'] = -1; goto MzE5e; bf6lR: KHfDs: goto MZ9hM; YuYiz: $xml = '<?xml version="1.0" encoding="utf-8"?>' . $resp['content']; goto ZsY1H; bvpbF: $ret['dissuccess'] = 0; goto TTTT8; nzcOp: ywnMP: goto J9ZOn; EEcjU: $error = $xpath->evaluate('string(//xml/err_code_des)'); goto j6MWo; gP08E: $pars['wxappid'] = $cfg['appid']; goto VGf_s; GiVa5: $extras['CURLOPT_SSLCERT'] = $root . 'apiclient_cert.pem'; goto vmCyA; vmCyA: $extras['CURLOPT_SSLKEY'] = $root . 'apiclient_key.pem'; goto JkT4N; ZvMdp: goto TQv_2; goto nzcOp; JpnLb: $ret['message'] = $error; goto XBSlN; puTCB: $pars['client_ip'] = $cfg['ip']; goto A8dfa; y1k92: goto KHfDs; goto oztEE; JkT4N: load()->func('communication'); goto rzj_E; rzj_E: $procResult = null; goto jAP3R; DPQHL: return $ret; goto W3p2p; QErXC: $ret['message'] = 'success'; goto dKK93; A8dfa: $pars['act_name'] = '提现红包'; goto as_jO; dCxSa: $string1 .= "key={$cfg['apikey']}"; goto oOa1D; XtEOg: $ret = array(); goto qMVZk; YnLyy: HQyzM: goto gjqXE; AqoEJ: goto ricNy; goto ZbM_V; UN9oi: $extras = array(); goto u7Whw; dYvwF: $ret['code'] = -1; goto bvpbF; KFGSd: if (is_error($resp)) { goto ywnMP; } goto YuYiz; uJ8lF: $dmch_billno = random(10) . date('Ymd') . random(3); goto OFHdy; MZ9hM: ricNy: goto ZvMdp; r6iDx: $ret['message'] = 'success'; goto WyKFK; C19CN: $ret['dissuccess'] = 0; goto H5OHp; B6H2Y: $pars['min_value'] = $dtotal_amount; goto abhbX; sikkP: $fans = mc_fetch($_W['openid']); goto ietIS; H5OHp: $ret['message'] = '3error3'; goto qcA2B; d292o: $pars['mch_id'] = $cfg['mchid']; goto gP08E; dKK93: $url = 'https://api.mch.weixin.qq.com/mmpaymkttransfers/sendredpack'; goto Hhruk; u7Whw: $extras['CURLOPT_CAINFO'] = $root . 'rootca.pem'; goto GiVa5; Zzft7: $pars['total_num'] = 1; goto BQuaA; i3Wy8: if (strtolower($code) == 'success' && strtolower($result) == 'success') { goto lWa7p; } goto EEcjU; as_jO: $pars['remark'] = '来自' . $_W['account']['name'] . '的红包'; goto c7Xjt; qMVZk: $ret['code'] = 0; goto QErXC; kVBiv: $pars['mch_billno'] = $dmch_billno; goto d292o; J9ZOn: $procResult = $resp['message']; goto dYvwF; oztEE: lWa7p: goto XMLuR; NtB_F: $ret['dissuccess'] = 1; goto r6iDx; vGA5I: return $ret; goto KMthh; Cj_2h: $string1 = ''; goto dLEwP; L3xaQ: $code = $xpath->evaluate('string(//xml/return_code)'); goto YlJWy; XMLuR: $ret['code'] = 0; goto NtB_F; KMthh: TQv_2: goto E9B0b; Sb47f: Dfk03: goto YnLyy; yWqML: $pars['send_name'] = $_W['account']['name']; goto KodVA; InIWe: if ($dom->loadXML($xml)) { goto lPLjc; } goto huvVG; KodVA: $pars['re_openid'] = $openid; goto fnTjY; W3p2p: exit; goto Sb47f; ietIS: $dtotal = $dtotal_amount / 100; goto tGckQ; gjqXE: if (!empty($dmch_billno)) { goto sle5f; } goto uJ8lF; dLEwP: foreach ($pars as $k => $v) { $string1 .= "{$k}={$v}&"; RQSQP: } goto zrQJb; j6MWo: $ret['code'] = -2; goto kPqUk; YlJWy: $result = $xpath->evaluate('string(//xml/result_code)'); goto i3Wy8; ZsY1H: $dom = new DOMDocument(); goto InIWe; gVu6y: load()->model('mc'); goto N2qNc; zrQJb: nOEF7: goto dCxSa; Hhruk: $pars = array(); goto E9BMN; tGckQ: if (!($dtotal > $fans['credit2'])) { goto Dfk03; } goto RLJ27; c7Xjt: ksort($pars, SORT_STRING); goto Cj_2h; MzE5e: $ret['dissuccess'] = 0; goto q1Ct5; qcA2B: return $ret; goto AqoEJ; XBSlN: return $ret; goto y1k92; tb3ue: global $_W; goto gVu6y; OFHdy: sle5f: goto MuT3S; MuT3S: $root = IA_ROOT . '/attachment/tiger_newhu/cert/' . $_W['uniacid'] . '/'; goto XtEOg; huvVG: $ret['code'] = -3; goto C19CN; BQuaA: $pars['wishing'] = '提现红包成功!'; goto puTCB; WyKFK: return $ret; goto bf6lR; fCSG5: $xpath = new DOMXPath($dom); goto L3xaQ; VGf_s: $pars['nick_name'] = $_W['account']['name']; goto yWqML; kPqUk: $ret['dissuccess'] = 0; goto JpnLb; ZbM_V: lPLjc: goto fCSG5; fnTjY: $pars['total_amount'] = $dtotal_amount; goto B6H2Y; N2qNc: if (empty($desc)) { goto HQyzM; } goto sikkP; oOa1D: $pars['sign'] = strtoupper(md5($string1)); goto HGLJX; E9BMN: $pars['nonce_str'] = random(32); goto kVBiv; q1Ct5: $ret['message'] = '余额不足'; goto DPQHL; jAP3R: $resp = ihttp_request($url, $xml, $extras); goto KFGSd; HGLJX: $xml = array2xml($pars); goto UN9oi; abhbX: $pars['max_value'] = $dtotal_amount; goto Zzft7; E9B0b: } public function post_qyfk($cfg, $openid, $amount, $desc, $dmch_billno) { goto LsgTr; jcx6B: OM_Bz: goto sAGmF; UyPqF: if (empty($desc)) { goto fNVLj; } goto TasOs; fLEAA: foreach ($pars as $k => $v) { $string1 .= "{$k}={$v}&"; Pahoc: } goto jcx6B; mu3GY: exit; goto b8804; Lv4nj: $code = $xpath->evaluate('string(//xml/return_code)'); goto EVIu9; EVIu9: $result = $xpath->evaluate('string(//xml/result_code)'); goto GBtxn; U3P14: if (!empty($dmch_billno)) { goto LxSsQ; } goto yTIbW; yVAsT: eoVEM: goto Gz4cB; QpXob: $pars = array(); goto tYkcw; M3cjO: $ret['message'] = '-2:' . $error; goto erlD0; MB5mb: return $ret; goto fnjpN; vBT2A: $ret['code'] = 0; goto xD2pc; UjAN1: load()->model('mc'); goto UyPqF; vaVj7: $ret['dissuccess'] = 1; goto aa4lC; OsTkH: return $ret; goto KI_8k; QHwNp: $extras = array(); goto VmEMR; QFIEh: return $ret; goto JYB19; Ankqq: $procResult = $resp['message']; goto eXbmD; RcMg1: $ret = array(); goto vBT2A; tof03: $ret['dissuccess'] = 0; goto D9QPC; zRCEg: $pars['desc'] = '来自' . $_W['account']['name'] . '的提现'; goto ozXHU; xYrOr: $error = $xpath->evaluate('string(//xml/err_code_des)'); goto r6Fkc; N44H6: $root = IA_ROOT . '/attachment/tiger_newhu/cert/' . $_W['uniacid'] . '/'; goto RcMg1; yTIbW: $dmch_billno = random(10) . date('Ymd') . random(3); goto eoVVE; IQh2W: load()->func('communication'); goto z28ry; ozXHU: $pars['spbill_create_ip'] = $cfg['ip']; goto BXh71; I4DX4: jbFXi: goto Ankqq; LsgTr: global $_W; goto UjAN1; ygUd3: $ret['message'] = '余额不足'; goto YqqEf; eoVVE: LxSsQ: goto N44H6; D9QPC: $ret['message'] = 'error response'; goto QFIEh; KI_8k: Y7nHu: goto xhZUl; r6Fkc: $ret['code'] = -2; goto UnU72; TasOs: $fans = mc_fetch($_W['openid']); goto Te81S; vN_63: $extras['CURLOPT_SSLKEY'] = $root . 'apiclient_key.pem'; goto IQh2W; sAGmF: $string1 .= "key={$cfg['apikey']}"; goto EUll6; DqzFC: $pars['partner_trade_no'] = $dmch_billno; goto RNoKB; lbxvo: if (!($dtotal > $fans['credit2'])) { goto Awa6P; } goto RPGI1; VmEMR: $extras['CURLOPT_CAINFO'] = $root . 'rootca.pem'; goto ifN0I; shOW_: $xml = '<?xml version="1.0" encoding="utf-8"?>' . $resp['content']; goto FPUFY; b8804: Awa6P: goto RtTSl; UCoTo: $ret['dissuccess'] = 0; goto CmKeX; mSZfp: $ret['code'] = -3; goto tof03; FPUFY: $dom = new DOMDocument(); goto gYGaN; erlD0: return $ret; goto rbwzY; CCDDN: $pars['mchid'] = $cfg['mchid']; goto JGcRh; eXbmD: $ret['code'] = -1; goto UCoTo; E9bo1: bw_mb: goto EDZrb; lOEOO: $string1 = ''; goto fLEAA; UnU72: $ret['dissuccess'] = 0; goto M3cjO; HniFx: $xpath = new DOMXPath($dom); goto Lv4nj; fnjpN: LO6b1: goto E9bo1; RsCN3: $xml = array2xml($pars); goto QHwNp; ih0ej: if (is_error($resp)) { goto jbFXi; } goto shOW_; xD2pc: $ret['message'] = 'success'; goto BHQOJ; uPZZ8: $url = 'https://api.mch.weixin.qq.com/mmpaymkttransfers/promotion/transfers'; goto QpXob; RPGI1: $ret['code'] = -1; goto t8xjz; PSypA: uuEKz: goto HniFx; ifN0I: $extras['CURLOPT_SSLCERT'] = $root . 'apiclient_cert.pem'; goto vN_63; RtTSl: fNVLj: goto U3P14; Gz4cB: $ret['code'] = 0; goto vaVj7; Te81S: $dtotal = $amount / 100; goto lbxvo; JGcRh: $pars['nonce_str'] = random(32); goto DqzFC; CmKeX: $ret['message'] = '-1:' . $procResult; goto OsTkH; GBtxn: if (strtolower($code) == 'success' && strtolower($result) == 'success') { goto eoVEM; } goto xYrOr; YqqEf: return $ret; goto mu3GY; t8xjz: $ret['dissuccess'] = 0; goto ygUd3; gYGaN: if ($dom->loadXML($xml)) { goto uuEKz; } goto mSZfp; rbwzY: goto LO6b1; goto yVAsT; aa4lC: $ret['message'] = 'success'; goto MB5mb; F9kLF: $resp = ihttp_request($url, $xml, $extras); goto ih0ej; EDZrb: goto Y7nHu; goto I4DX4; EUll6: $pars['sign'] = strtoupper(md5($string1)); goto RsCN3; RNoKB: $pars['openid'] = $openid; goto VT6U7; z28ry: $procResult = null; goto F9kLF; b_11n: $pars['amount'] = $amount; goto zRCEg; VT6U7: $pars['check_name'] = 'NO_CHECK'; goto b_11n; BXh71: ksort($pars, SORT_STRING); goto lOEOO; BHQOJ: $ret['amount'] = $amount; goto uPZZ8; tYkcw: $pars['mch_appid'] = $cfg['appid']; goto CCDDN; JYB19: goto bw_mb; goto PSypA; xhZUl: } public function postText($openid, $text) { goto ENrMv; OSYbr: return $ret; goto mj57G; ENrMv: $post = '{"touser":"' . $openid . '","msgtype":"text","text":{"content":"' . $text . '"}}'; goto lWbQB; lWbQB: $ret = $this->postRes($this->getAccessToken(), $post); goto OSYbr; mj57G: } private function postRes($access_token, $data) { goto JqIBN; JqIBN: $url = "https://api.weixin.qq.com/cgi-bin/message/custom/send?access_token={$access_token}"; goto eKRyu; maoD1: $ret = ihttp_request($url, $data); goto X_dix; X_dix: $content = @json_decode($ret['content'], true); goto Iv5jF; eKRyu: load()->func('communication'); goto maoD1; Iv5jF: return $content['errcode']; goto XeVJc; XeVJc: } public function jdviewzl($itemid, $p_id, $discount_link) { goto OmDQD; TB3P_: $goodslist = $this->cjget('jd.union.open.promotion.bysubunionid.get', $arr); goto BeKxD; OmDQD: $arr = array(); goto npt2K; E2aSs: return $arr['message']; goto Q0yL3; npt2K: $arr['materialId'] = 'https://wqitem.jd.com/item/view?sku=' . $itemid; goto pdayV; qSLKp: $arr['chainType'] = '2'; goto oVGFl; SGHxp: $arr = json_decode($arr['jd_union_open_promotion_bysubunionid_get_response']['result'], true); goto ehPsY; ISR3J: $arr['couponUrl'] = $discount_link; goto qSLKp; AXRtv: Mg6qU: goto p2GzB; oVGFl: $arr = array("promotionCodeReq" => $arr); goto TB3P_; Q0yL3: goto Mg6qU; goto KhXuV; ehPsY: if ($arr['message'] == 'success') { goto dglxB; } goto E2aSs; pdayV: $arr['positionId'] = $p_id; goto ISR3J; O2ovt: return $arr['data']['shortURL']; goto AXRtv; KhXuV: dglxB: goto O2ovt; BeKxD: $arr = json_decode($goodslist, true); goto SGHxp; p2GzB: } public function cjget($method, $arr) { goto w7fjh; LBQ9z: $url = 'https://router.jd.com/api?v=1.0&method=' . $method . '&app_key=' . $app_key . '&sign_method=md5&format=json&timestamp=' . urlencode($timestamp) . '&sign=' . $sign . '&param_json=' . urlencode($param_json); goto XSspA; KF1bh: $timestamp = date('Y-m-d H:i:s', time()); goto PCzwV; y9mnC: return $arr; goto bxVvz; w7fjh: $app_key = 'd208dae5afb44db190b8f912e4c6de02'; goto KF1bh; tJQ2O: $arr1 = array("timestamp" => $timestamp, "v" => "1.0", "sign_method" => "md5", "format" => "json", "method" => $method, "param_json" => $param_json, "app_key" => $app_key); goto kC2H0; PCzwV: $param_json = json_encode($arr); goto tJQ2O; QUE3m: $sign = $this->jdsign1($pxarr); goto LBQ9z; kC2H0: $pxarr = $this->jdcs1px($arr1); goto QUE3m; XSspA: $arr = $this->tigercurl($url); goto y9mnC; bxVvz: } function tigercurl($url, $params = false, $ispost = 0) { goto T5ohs; g6YbJ: goto Yw20M; goto vTMMf; ue6wq: mB48G: goto ui01c; HkBQb: $httpInfo = array_merge($httpInfo, curl_getinfo($ch)); goto Kz3TE; nUhYU: $response = curl_exec($ch); goto CMoXO; ZqFQ4: curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); goto fsXft; qf9ir: $ch = curl_init(); goto tUQLX; tUQLX: curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1); goto buaFX; Lr6Vd: curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); goto ZqFQ4; sf91b: return false; goto mqufJ; dK_w2: curl_setopt($ch, CURLOPT_URL, $url); goto T4J0V; Q0BTx: curl_setopt($ch, CURLOPT_POST, true); goto CUfzi; hOK9M: if ($params) { goto mB48G; } goto dK_w2; buaFX: curl_setopt($ch, CURLOPT_USERAGENT, 'JuheData'); goto g1wWj; CMoXO: if (!($response === FALSE)) { goto IKH0i; } goto sf91b; CUfzi: curl_setopt($ch, CURLOPT_POSTFIELDS, $params); goto sd9kD; T4J0V: goto EMZCs; goto ue6wq; sd9kD: curl_setopt($ch, CURLOPT_URL, $url); goto TtkHi; fsXft: if ($ispost) { goto xGvHq; } goto hOK9M; mdEuo: $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); goto HkBQb; T5ohs: $httpInfo = array(); goto qf9ir; g1wWj: curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 60); goto Jj9yP; vTMMf: xGvHq: goto Q0BTx; mqufJ: IKH0i: goto mdEuo; Jj9yP: curl_setopt($ch, CURLOPT_TIMEOUT, 60); goto Lr6Vd; Kz3TE: curl_close($ch); goto AtM3i; AtM3i: return $response; goto ZjXuh; TtkHi: Yw20M: goto nUhYU; k9yCh: EMZCs: goto g6YbJ; ui01c: curl_setopt($ch, CURLOPT_URL, $url . '?' . $params); goto k9yCh; ZjXuh: } public function jdcs1px($array) { goto oNC3k; oNC3k: ksort($array); goto N8u_M; FCKjL: goto GTxhA; goto HgGet; BeS2u: if (!(list($key, $val) = each($array))) { goto FR3Cr; } goto zYaH6; zYaH6: $string = $string . $key . $val; goto FCKjL; D2WHT: return trim($string); goto zTTGM; MTN61: GTxhA: goto BeS2u; N8u_M: $string = ''; goto MTN61; HgGet: FR3Cr: goto D2WHT; zTTGM: } public function jdcs2px($array) { ksort($array); return json_encode($array); } public function jdsign1($arr1) { goto QWJ8k; c_WvT: $string = $App_Secret . $arr1 . $App_Secret; goto OBSAE; I2sg8: return strtoupper($md5str); goto Y0LZ1; QWJ8k: $app_key = 'd208dae5afb44db190b8f912e4c6de02'; goto g7cVB; OBSAE: $md5str = MD5($string); goto I2sg8; g7cVB: $App_Secret = '176fa13b38594dc187f4719fcc0c7253'; goto c_WvT; Y0LZ1: } } ?>